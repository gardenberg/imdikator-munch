splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$bydel_nr[splitDF$bydel_nr<99999]=paste0("0",splitDF$bydel_nr)
splitDF$barnikommune = gsub("\\.","_",splitDF$barnikommune)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2014
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-bydel-2014.csv",row.names=F)
barnehagedeltakelse <- read.csv("data_crossed_input/30-barnehagedeltakelse-fylke-2013.csv", header=T, row.names=NULL, sep=";", dec=",", na.strings = c("NA",".",":"),stringsAsFactors = F)
samlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with("barnikommune")))
samlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with("barnikommune"))
View(samlaDF)
sum(is.na(samlaDF$tabellvariabel))
sum(is.na(samlaDF$tabellvariabel_2))
samlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))
samlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))
splitDF=separate(samlaDF_1,variabler,c("spraak","bhgalder","enhet"),"_")
splitDF=separate(splitDF,spraak,c("variabel","spraak"),7)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$fylke_nr[splitDF$fylke_nr<10]=paste0("0",splitDF$fylke_nr)
splitDF=separate(samlaDF_1,variabler,c("spraak","bhgalder","enhet"),"_")
splitDF=separate(splitDF,spraak,c("variabel","spraak"),7)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$fylke_nr[splitDF$fylke_nr<10]
str(splitDF$fylke_nr)
splitDF$fylke_nr[splitDF$fylke_nr==1]=paste0("0",splitDF$fylke_nr)
View(samlaDF)
View(splitDF)
splitDF$fylke_nr==1
splitDF=separate(samlaDF_1,variabler,c("spraak","bhgalder","enhet"),"_")
splitDF=separate(splitDF,spraak,c("variabel","spraak"),7)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
sum(splitDF$fylke_nr[splitDF$fylke_nr<10])
splitDF$fylke_nr[splitDF$fylke_nr=<9] = paste0("0",splitDF$fylke_nr)
splitDF$fylke_nr[splitDF$fylke_nr<=9] = paste0("0",splitDF$fylke_nr)
splitDF=separate(samlaDF_1,variabler,c("spraak","bhgalder","enhet"),"_")
splitDF=separate(splitDF,spraak,c("variabel","spraak"),7)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$spraak = gsub("\\.","_",splitDF$spraak)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2013
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-fylke-2013.csv",row.names=F)
#BHGALDER
splitDF=separate(samlaDF_2,variabler_2,c("barnikommune","bhgalder","enhet"),"_")
splitDF=separate(splitDF,barnikommune,c("variabel","barnikommune"),(nchar("barnikommume")+1))
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$barnikommune = gsub("\\.","_",splitDF$barnikommune)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2013
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-fylke-2013.csv",row.names=F)
View(splitDF)
?nrchars
?nchar
nchar(splitDF$fylke_nr)
splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1]
splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0("0",splitDF$fylke_nr)
splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0("0",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])
splitDF=separate(samlaDF_1,variabler,c("spraak","bhgalder","enhet"),"_")
library(tidyr)
splitDF=separate(samlaDF_1,variabler,c("spraak","bhgalder","enhet"),"_")
splitDF=separate(splitDF,spraak,c("variabel","spraak"),7)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0("0",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])
View(splitDF)
splitDF$spraak = gsub("\\.","_",splitDF$spraak)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2013
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-fylke-2013.csv",row.names=F)
splitDF=separate(samlaDF_2,variabler_2,c("barnikommune","bhgalder","enhet"),"_")
splitDF=separate(splitDF,barnikommune,c("variabel","barnikommune"),(nchar("barnikommume")+1))
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0("0",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])
splitDF$barnikommune = gsub("\\.","_",splitDF$barnikommune)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2013
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-fylke-2013.csv",row.names=F)
#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - FYLKE2014
barnehagedeltakelse <- read.csv("data_crossed_input/30-barnehagedeltakelse-fylke-2014.csv", header=T, row.names=NULL, sep=";", dec=",", na.strings = c("NA",".",":"),stringsAsFactors = F)
samlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with("barnikommune")))
samlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with("barnikommune"))
sum(is.na(samlaDF$tabellvariabel))
sum(is.na(samlaDF$tabellvariabel_2))
samlaDF$tabellvariabel[is.na(samlaDF$tabellvariabel)]="."
samlaDF$tabellvariabel_2[is.na(samlaDF$tabellvariabel_2)]="."
sum(is.na(samlaDF$tabellvariabel))
sum(is.na(samlaDF$tabellvariabel_2))
#lager to df, en med barnikommune og en med spraak
samlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))
samlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))
#SPRAAK
splitDF=separate(samlaDF_1,variabler,c("spraak","bhgalder","enhet"),"_")
splitDF=separate(splitDF,spraak,c("variabel","spraak"),7)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0("0",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])
splitDF$spraak = gsub("\\.","_",splitDF$spraak)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2014
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-fylke-2014.csv",row.names=F)
#BHGALDER
splitDF=separate(samlaDF_2,variabler_2,c("barnikommune","bhgalder","enhet"),"_")
splitDF=separate(splitDF,barnikommune,c("variabel","barnikommune"),(nchar("barnikommume")+1))
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0("0",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])
splitDF$barnikommune = gsub("\\.","_",splitDF$barnikommune)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2014
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-fylke-2014.csv",row.names=F)
#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - FYLKE2014
barnehagedeltakelse <- read.csv("data_crossed_input/30-barnehagedeltakelse-fylke-2014.csv", header=T, row.names=NULL, sep=";", dec=",", na.strings = c("NA",".",":"),stringsAsFactors = F)
samlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with("barnikommune")))
samlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with("barnikommune"))
sum(is.na(samlaDF$tabellvariabel))
sum(is.na(samlaDF$tabellvariabel_2))
samlaDF$tabellvariabel[is.na(samlaDF$tabellvariabel)]="."
samlaDF$tabellvariabel_2[is.na(samlaDF$tabellvariabel_2)]="."
sum(is.na(samlaDF$tabellvariabel))
sum(is.na(samlaDF$tabellvariabel_2))
#lager to df, en med barnikommune og en med spraak
samlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))
samlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))
#SPRAAK
splitDF=separate(samlaDF_1,variabler,c("spraak","bhgalder","enhet"),"_")
splitDF=separate(splitDF,spraak,c("variabel","spraak"),7)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0("0",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])
splitDF$spraak = gsub("\\.","_",splitDF$spraak)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2014
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-fylke-2014.csv",row.names=F)
#BHGALDER
splitDF=separate(samlaDF_2,variabler_2,c("barnikommune","bhgalder","enhet"),"_")
splitDF=separate(splitDF,barnikommune,c("variabel","barnikommune"),(nchar("barnikommume")+1))
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0("0",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])
splitDF$barnikommune = gsub("\\.","_",splitDF$barnikommune)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2014
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-fylke-2014.csv",row.names=F)
barnehagedeltakelse <- read.csv("data_crossed_input/30-barnehagedeltakelse-kommune-2013.csv", header=T, row.names=NULL, sep=";", dec=",", na.strings = c("NA",".",":"),stringsAsFactors = F)
View(barnehagedeltakelse)
barnehagedeltakelse <- read.csv("data_crossed_input/30-barnehagedeltakelse-kommune-2013.csv", header=T, row.names=NULL, sep=";", dec=",", stringsAsFactors = F)
samlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with("barnikommune")))
samlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with("barnikommune"))
sum(is.na(samlaDF$tabellvariabel))
sum(is.na(samlaDF$tabellvariabel_2))
sum(is.na(samlaDF$tabellvariabel))
sum(is.na(samlaDF$tabellvariabel_2))
#lager to df, en med barnikommune og en med spraak
samlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))
samlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))
#SPRAAK
splitDF=separate(samlaDF_1,variabler,c("spraak","bhgalder","enhet"),"_")
splitDF=separate(splitDF,spraak,c("variabel","spraak"),7)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
View(splitDF)
splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3] = paste0("0",splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3])
View(splitDF)
splitDF$spraak = gsub("\\.","_",splitDF$spraak)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-kommune-2013.csv",row.names=F)
#BHGALDER
splitDF=separate(samlaDF_2,variabler_2,c("barnikommune","bhgalder","enhet"),"_")
splitDF=separate(splitDF,barnikommune,c("variabel","barnikommune"),(nchar("barnikommume")+1))
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3] = paste0("0",splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3])
splitDF$barnikommune = gsub("\\.","_",splitDF$barnikommune)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2013
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-kommune-2013.csv",row.names=F)
barnehagedeltakelse <- read.csv("data_crossed_input/30-barnehagedeltakelse-kommune-2014.csv", header=T, row.names=NULL, sep=";", dec=",", stringsAsFactors = F)
#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - KOMMUNE2014
barnehagedeltakelse <- read.csv("data_crossed_input/30-barnehagedeltakelse-kommune-2014.csv", header=T, row.names=NULL, sep=";", dec=",", stringsAsFactors = F)
samlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with("barnikommune")))
samlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with("barnikommune"))
sum(is.na(samlaDF$tabellvariabel))
sum(is.na(samlaDF$tabellvariabel_2))
samlaDF$tabellvariabel[is.na(samlaDF$tabellvariabel)]="."
samlaDF$tabellvariabel_2[is.na(samlaDF$tabellvariabel_2)]="."
sum(is.na(samlaDF$tabellvariabel))
sum(is.na(samlaDF$tabellvariabel_2))
#lager to df, en med barnikommune og en med spraak
samlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))
samlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))
#SPRAAK
splitDF=separate(samlaDF_1,variabler,c("spraak","bhgalder","enhet"),"_")
splitDF=separate(splitDF,spraak,c("variabel","spraak"),7)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3] = paste0("0",splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3])
splitDF$spraak = gsub("\\.","_",splitDF$spraak)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2014
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-kommune-2014.csv",row.names=F)
#BHGALDER
splitDF=separate(samlaDF_2,variabler_2,c("barnikommune","bhgalder","enhet"),"_")
splitDF=separate(splitDF,barnikommune,c("variabel","barnikommune"),(nchar("barnikommume")+1))
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3] = paste0("0",splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3])
splitDF$barnikommune = gsub("\\.","_",splitDF$barnikommune)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2014
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-kommune-2014.csv",row.names=F)
barnehagedeltakelse <- read.csv("data_crossed_input/30-barnehagedeltakelse-naringsregion-2013.csv", header=T, row.names=NULL, sep=";", dec=",", stringsAsFactors = F)
samlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with("barnikommune")))
samlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with("barnikommune"))
sum(is.na(samlaDF$tabellvariabel))
sum(is.na(samlaDF$tabellvariabel_2))
samlaDF$tabellvariabel[is.na(samlaDF$tabellvariabel)]="."
samlaDF$tabellvariabel_2[is.na(samlaDF$tabellvariabel_2)]="."
sum(is.na(samlaDF$tabellvariabel))
sum(is.na(samlaDF$tabellvariabel_2))
#lager to df, en med barnikommune og en med spraak
samlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))
samlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))
#SPRAAK
splitDF=separate(samlaDF_1,variabler,c("spraak","bhgalder","enhet"),"_")
splitDF=separate(splitDF,spraak,c("variabel","spraak"),7)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1] = paste0("0",splitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1])
splitDF$spraak = gsub("\\.","_",splitDF$spraak)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2013
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-naringsregion-2013.csv",row.names=F)
#BHGALDER
splitDF=separate(samlaDF_2,variabler_2,c("barnikommune","bhgalder","enhet"),"_")
splitDF=separate(splitDF,barnikommune,c("variabel","barnikommune"),(nchar("barnikommume")+1))
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1] = paste0("0",splitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1])
splitDF$barnikommune = gsub("\\.","_",splitDF$barnikommune)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2013
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-naringsregion-2013.csv",row.names=F)
#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - NÆRINGSREGION2014
barnehagedeltakelse <- read.csv("data_crossed_input/30-barnehagedeltakelse-naringsregion-2014.csv", header=T, row.names=NULL, sep=";", dec=",", stringsAsFactors = F)
samlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with("barnikommune")))
samlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with("barnikommune"))
sum(is.na(samlaDF$tabellvariabel))
sum(is.na(samlaDF$tabellvariabel_2))
samlaDF$tabellvariabel[is.na(samlaDF$tabellvariabel)]="."
samlaDF$tabellvariabel_2[is.na(samlaDF$tabellvariabel_2)]="."
sum(is.na(samlaDF$tabellvariabel))
sum(is.na(samlaDF$tabellvariabel_2))
#lager to df, en med barnikommune og en med spraak
samlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))
samlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))
#SPRAAK
splitDF=separate(samlaDF_1,variabler,c("spraak","bhgalder","enhet"),"_")
splitDF=separate(splitDF,spraak,c("variabel","spraak"),7)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1] = paste0("0",splitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1])
splitDF$spraak = gsub("\\.","_",splitDF$spraak)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2014
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-naringsregion-2014.csv",row.names=F)
#BHGALDER
splitDF=separate(samlaDF_2,variabler_2,c("barnikommune","bhgalder","enhet"),"_")
splitDF=separate(splitDF,barnikommune,c("variabel","barnikommune"),(nchar("barnikommume")+1))
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1] = paste0("0",splitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1])
splitDF$barnikommune = gsub("\\.","_",splitDF$barnikommune)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2014
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-naringsregion-2014.csv",row.names=F)
barnehagedeltakelse <- read.csv("data_crossed_input/30-barnehagedeltakelse-bydel-2013.csv", header=T, row.names=NULL, sep=";", dec=",",,stringsAsFactors = F)
samlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with("barnikommune")))
samlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with("barnikommune"))
sum(is.na(samlaDF$tabellvariabel))
samlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))
samlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))
#splitter så opp. må gjøres posisjonsvis. SPRAAK FØRST
#bruk av _ som separator i variabelnavn gir trøbbel,
splitDF=separate(samlaDF_1,variabler,c("spraak","bhgalder","enhet"),"_")
splitDF=separate(splitDF,spraak,c("variabel","spraak"),7)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
#erstatter nye tegn
splitDF$bydel_nr[splitDF$bydel_nr<99999]=paste0("0",splitDF$bydel_nr)
View(splitDF)
splitDF$spraak = gsub("\\.","_",splitDF$spraak)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
#legger til øvrige nødvendige verdier
splitDF$aar = 2013
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-bydel-2013.csv",row.names=F)
#BHGALDER
#bruk av _ som separator i variabelnavn gir trøbbel,
splitDF=separate(samlaDF_2,variabler_2,c("barnikommune","bhgalder","enhet"),"_")
splitDF=separate(splitDF,barnikommune,c("variabel","barnikommune"),(nchar("barnikommume")+1))
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
#erstatter nye tegn
splitDF$bydel_nr[splitDF$bydel_nr<99999]=paste0("0",splitDF$bydel_nr)
splitDF$barnikommune = gsub("\\.","_",splitDF$barnikommune)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
#legger til øvrige nødvendige verdier
splitDF$aar = 2013
splitDF$tabell_navn = "barnehagedeltakelse"
#skriver ut fil
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-bydel-2013.csv",row.names=F)
#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - BYDEL2014
barnehagedeltakelse <- read.csv("data_crossed_input/30-barnehagedeltakelse-bydel-2014.csv", header=T, row.names=NULL, sep=";", dec=",", stringsAsFactors = F)
samlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with("barnikommune")))
samlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with("barnikommune"))
#lager to df, en med barnikommune og en med spraak
samlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))
samlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))
#SPRAAK
splitDF=separate(samlaDF_1,variabler,c("spraak","bhgalder","enhet"),"_")
splitDF=separate(splitDF,spraak,c("variabel","spraak"),7)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$bydel_nr[splitDF$bydel_nr<99999]=paste0("0",splitDF$bydel_nr)
splitDF$spraak = gsub("\\.","_",splitDF$spraak)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2014
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-bydel-2014.csv",row.names=F)
#BHGALDER
splitDF=separate(samlaDF_2,variabler_2,c("barnikommune","bhgalder","enhet"),"_")
splitDF=separate(splitDF,barnikommune,c("variabel","barnikommune"),(nchar("barnikommume")+1))
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$bydel_nr[splitDF$bydel_nr<99999]=paste0("0",splitDF$bydel_nr)
splitDF$barnikommune = gsub("\\.","_",splitDF$barnikommune)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2014
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-bydel-2014.csv",row.names=F)
#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - FYLKE2013
barnehagedeltakelse <- read.csv("data_crossed_input/30-barnehagedeltakelse-fylke-2013.csv", header=T, row.names=NULL, sep=";", dec=",",stringsAsFactors = F)
samlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with("barnikommune")))
samlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with("barnikommune"))
sum(is.na(samlaDF$tabellvariabel))
sum(is.na(samlaDF$tabellvariabel_2))
samlaDF$tabellvariabel[is.na(samlaDF$tabellvariabel)]="."
samlaDF$tabellvariabel_2[is.na(samlaDF$tabellvariabel_2)]="."
sum(is.na(samlaDF$tabellvariabel))
sum(is.na(samlaDF$tabellvariabel_2))
#lager to df, en med barnikommune og en med spraak
samlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))
samlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))
#SPRAAK
splitDF=separate(samlaDF_1,variabler,c("spraak","bhgalder","enhet"),"_")
splitDF=separate(splitDF,spraak,c("variabel","spraak"),7)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0("0",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])
splitDF$spraak = gsub("\\.","_",splitDF$spraak)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2013
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-fylke-2013.csv",row.names=F)
#BHGALDER
splitDF=separate(samlaDF_2,variabler_2,c("barnikommune","bhgalder","enhet"),"_")
splitDF=separate(splitDF,barnikommune,c("variabel","barnikommune"),(nchar("barnikommume")+1))
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0("0",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])
splitDF$barnikommune = gsub("\\.","_",splitDF$barnikommune)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2013
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-fylke-2013.csv",row.names=F)
#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - FYLKE2014
barnehagedeltakelse <- read.csv("data_crossed_input/30-barnehagedeltakelse-fylke-2014.csv", header=T, row.names=NULL, sep=";", dec=",",stringsAsFactors = F)
samlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with("barnikommune")))
samlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with("barnikommune"))
sum(is.na(samlaDF$tabellvariabel))
sum(is.na(samlaDF$tabellvariabel_2))
samlaDF$tabellvariabel[is.na(samlaDF$tabellvariabel)]="."
samlaDF$tabellvariabel_2[is.na(samlaDF$tabellvariabel_2)]="."
sum(is.na(samlaDF$tabellvariabel))
sum(is.na(samlaDF$tabellvariabel_2))
#lager to df, en med barnikommune og en med spraak
samlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))
samlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))
#SPRAAK
splitDF=separate(samlaDF_1,variabler,c("spraak","bhgalder","enhet"),"_")
splitDF=separate(splitDF,spraak,c("variabel","spraak"),7)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0("0",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])
splitDF$spraak = gsub("\\.","_",splitDF$spraak)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2014
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-fylke-2014.csv",row.names=F)
#BHGALDER
splitDF=separate(samlaDF_2,variabler_2,c("barnikommune","bhgalder","enhet"),"_")
splitDF=separate(splitDF,barnikommune,c("variabel","barnikommune"),(nchar("barnikommume")+1))
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,bhgalder,c("variabel","bhgalder"),9)
splitDF=subset(splitDF,select=-variabel)
splitDF=separate(splitDF,enhet,c("variabel","enhet"),6)
splitDF=subset(splitDF,select=-variabel)
splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0("0",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])
splitDF$barnikommune = gsub("\\.","_",splitDF$barnikommune)
splitDF$bhgalder = gsub("\\.","_",splitDF$bhgalder)
splitDF$aar = 2014
splitDF$tabell_navn = "barnehagedeltakelse"
write.csv(splitDF,"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-fylke-2014.csv",row.names=F)
