df=spread(befolkning_botid,bydel_nr,tabellvariabel,drop=F)
df=spread(befolkning_botid,botid_5,tabellvariabel,drop=F)
View(df)
df$alle_kopi=df$alle
df$alle=extract_numeric(df[,6])+extract_numeric(df[,7])+extract_numeric(df[,8])
sum(is.na(df$alle))
df_2=gather(df,botid_5,tabellvariabel,6:10,na.rm=F)
View(df_2)
df_2=gather(df,botid_5,tabellvariabel,6:9,na.rm=F)
View(df_2)
df = subset(df,select=-alle_kopi)
View(df)
df_2=gather(df,botid_5,tabellvariabel,6:9,na.rm=F)
nrow(befolkning_botid)==18*3*4
18*3*4
befolkning_botid=gather(df,botid_5,tabellvariabel,6:9,na.rm=F)
View(befolkning_botid)
befolkning_botid$tabell_navn="befolkning_botid"
befolkning_botid$enhet = "personer"
write.csv(befolkning_botid,"D:/R/imdikator-munch/data_flat_output/befolkning_botid-bydel-2015.csv",row.names=F)
befolkning_botid <- read.csv("D:/R/imdikator-munch/data_flat_input/befolkning_botid_K_2015_v2.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
View(befolkning_botid)
levels(as.factor(befolkning_botid$botid_5))
levels(as.factor(befolkning_botid$vreg_3))
names(befolkning_botid)[3] = "kommune_nr"
befolkning_botid = subset(befolkning_botid,kommune_nr!="NULL")
befolkning_botid$tabell_navn="befolkning_botid"
befolkning_botid$enhet = "personer"
?nlevels
nlevels(as.factor(befolkning_botid$kommune_nr))
4*3*428
3*3*428
df=spread(befolkning_botid,botid_5,tabellvariabel,drop=F)
View(df)
sum(is.na(df$`0_4`))
sum(is.na(df$`10+`))
sum(is.na(df$`5_9`))
?spread
df=spread(befolkning_botid,botid_5,tabellvariabel,drop=F,fill=".")
sum(is.na(df$`0_4`))
sum(is.na(df$`10+`))
sum(is.na(df$`5_9`))
df$alle=extract_numeric(df[,6])+extract_numeric(df[,7])+extract_numeric(df[,8])
?extract_numeric
sum(is.na(df$alle))
df$alle(is.na(df$alle))
df$alle(is.na(df$alle)==T)
df$alle[is.na(df$alle)==T]
df$alle[is.na(df$alle)==T]="."
df2=gather(df,botid_5,tabellvariabel,6:9,na.rm=F)
3*3*428
4*3*428
View(df2)
sum(is.na(df2$tabellvariabel))
befolkning_botid=gather(df,botid_5,tabellvariabel,6:9,na.rm=F)
write.csv(befolkning_botid,"D:/R/imdikator-munch/data_flat_output/befolkning_botid-kommune-2015.csv",row.names=F)
befolkning_botid <- read.csv("D:/R/imdikator-munch/data_flat_input/befolkning_botid_N_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
View(befolkning_botid)
befolkning_botid = subset(befolkning_botid,naringsregion_nr!="NULL")
befolkning_botid$tabell_navn="befolkning_botid"
befolkning_botid$enhet = "personer"
4*3*83
levels(as.factor(befolkning_botid$vreg_3))
befolkning_botid$vreg_3[befolkning_botid$vreg_3==" "]
befolkning_botid$vreg_3[befolkning_botid$vreg_3==" "]="alle"
levels(as.factor(befolkning_botid$botid_5))
df=spread(befolkning_botid,botid_5,tabellvariabel,drop=F)
View(df)
df$alle_kopi=df$alle
df$alle=extract_numeric(df[,6])+extract_numeric(df[,7])+extract_numeric(df[,8])
View(df)
df = subset(df,select=-alle_kopi)
sum(is.na(df$alle))
df2=gather(df,botid_5,tabellvariabel,6:9,na.rm=F)
View(df2)
4*3*428
4*3*428
4*3*83
befolkning_botid=gather(df,botid_5,tabellvariabel,6:9,na.rm=F)
write.csv(befolkning_botid,"D:/R/imdikator-munch/data_flat_output/befolkning_botid-naringsregion-2015.csv",row.names=F)
befolkning_botid <- read.csv("D:/R/imdikator-munch/data_flat_input/befolkning_botid_F_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
befolkning_botid_norge <- read.csv("D:/R/imdikator-munch/data_flat_input/befolkning_botid_L_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
View(befolkning_botid)
View(befolkning_botid_norge)
befolkning_botid$tabell_navn="befolkning_botid"
befolkning_botid$enhet = "personer"
nlevels(as.factor(befolkning_botid$fylke_nr))
4*3*20
befolkning_botid <- read.csv("D:/R/imdikator-munch/data_flat_input/befolkning_botid_F_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
# tabellnavn skrevet med stor forbokstav
# person må bli personer
# logisk sjekk av innholdet
# botid_5 == " " må bli "alle"
# vreg_3 == " " må bli alle
# enhet må bli personer
befolkning_botid$tabell_navn="befolkning_botid"
befolkning_botid$enhet = "personer"
levels(as.factor(befolkning_botid$vreg_3))
levels(as.factor(befolkning_botid$botid_5))
df=spread(befolkning_botid,botid_5,tabellvariabel,drop=F)
View(df)
df=spread(befolkning_botid,vreg_3,tabellvariabel,drop=F)
df$alle_kopi=df$alle
df$alle=extract_numeric(df[,6])+extract_numeric(df[,7])
df = subset(df,select=-alle_kopi)
sum(is.na(df$alle))
df2=gather(df,vreg_3,tabellvariabel,6:8,na.rm=F)
View(df2)
df=spread(befolkning_botid,botid_5,tabellvariabel,drop=F)
df=spread(df2,botid_5,tabellvariabel,drop=F)
View(df)
df$alle=extract_numeric(df[,6])+extract_numeric(df[,7])+extract_numeric(df[,8])
sum(is.na(df$alle))
df2=gather(df,botid_5,tabellvariabel,6:9,na.rm=F)
View(df2)
4*3*20
write.csv(befolkning_botid,"D:/R/imdikator-munch/data_flat_output/befolkning_botid-fylke-2015.csv",row.names=F)
befolkning_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/befolkning_flytting_B_2014.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
View(befolkning_flytting)
befolkning_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/befolkning_flytting_B_2014.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=",", dec=".",colClasses="character")
View(befolkning_flytting)
levels(as.factor(befolkning_botid$vreg_3))
levels(as.factor(befolkning_flytting$vreg_3))
levels(as.factor(befolkning_flytting$invkat_2))
befolkning_flytting$bydel_nr[nchar(befolkning_flytting$bydel_nr)==2] = paste0("0301",befolkning_flytting$bydel_nr[nchar(befolkning_flytting$bydel_nr)==2])
names(befolkning_flytting)[3] = "bydel_nr"
befolkning_flytting$bydel_nr[nchar(befolkning_flytting$bydel_nr)==2] = paste0("0301",befolkning_flytting$bydel_nr[nchar(befolkning_flytting$bydel_nr)==2])
df=spread(befolkning_flytting,invkat_2,tabellvariabel,drop=F)
library(tidyr)
df=spread(befolkning_flytting,invkat_2,tabellvariabel,drop=F)
View(df)
befolkning_flytting_vreg = subset(befolkning_flytting,invkat_2 =='innvandrere',select=-invkat_2)
View(befolkning_flytting_vreg)
befolkning_flytting_vreg$tabell_navn ="befolkning_flytting_vreg"
df=subset(befolkning_flytting,invkat_2=='alle',select=-vreg_3)
View(df)
df=subset(befolkning_flytting,vreg_3 =='alle',select=-vreg_3)
View(df)
befolkning_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/befolkning_flytting_B_2014.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=",", dec=".",colClasses="character")
# bydel_id må bli bydel_nr
# bydel_nr må få 0301 foran.
# tabellnavn må bli tabell_navn
# tabell må splittes i to: en med vreg og en uten vreg
# invkat2 må bli til invkat_3, dvs. befolkningen_forøvrig = alle-innvandrere
# invkat_3 må bli innvkat_2
# logisk sjekk av antall observasjoner etter det
names(befolkning_flytting)[1] = "tabell_navn"
names(befolkning_flytting)[3] = "bydel_nr"
befolkning_flytting$bydel_nr[nchar(befolkning_flytting$bydel_nr)==2] = paste0("0301",befolkning_flytting$bydel_nr[nchar(befolkning_flytting$bydel_nr)==2])
#befolkning_flytting_vreg
befolkning_flytting_vreg = subset(befolkning_flytting,invkat_2 =='innvandrere',select=-invkat_2)
befolkning_flytting_vreg$tabell_navn ="befolkning_flytting_vreg"
nlevels(as.factor(bydel_nr))
nlevels(as.factor(befolkning_flytting_vreg$bydel_nr))
levels(as.factor(befolkning_flytting_vreg$flytting))
3*nlevels(as.factor(befolkning_flytting_vreg$bydel_nr))*nlevels(as.factor(befolkning_flytting_vreg$flytting))
nrow(befolkning_flytting_vreg)==3*nlevels(as.factor(befolkning_flytting_vreg$bydel_nr))*nlevels(as.factor(befolkning_flytting_vreg$flytting))
write.csv(befolkning_flytting_vreg,"D:/R/imdikator-munch/data_flat_output/befolkning_flytting-bydel-2014.csv",row.names=F)
write.csv(befolkning_flytting_vreg,"D:/R/imdikator-munch/data_flat_output/befolkning_flytting_vreg-bydel-2014.csv",row.names=F)
befolkning_flytting=subset(befolkning_flytting,vreg_3 =='alle',select=-vreg_3)
View(befolkning_flytting)
df=spread(befolkning_flytting,invkat_2,tabellvariabel,drop=F)
View(df)
sum(is.na(df$alle))
sum(is.na(df$innvandrere))
df$befolkningen_ellers=extract_numeric(df[,6])-extract_numeric(df[,7])
sum(is.na(df$befolkningen_ellers))
df2=gather(df,innvkat_3,tabellvariabel,6:8,na.rm=F)
View(df2)
9*3*18
write.csv(befolkning_flytting,"D:/R/imdikator-munch/data_flat_output/befolkning_flytting-bydel-2014.csv",row.names=F)
befolkning_flytting=gather(df,innvkat_3,tabellvariabel,6:8,na.rm=F)
nrow(befolkning_flytting)==9*3*18
write.csv(befolkning_flytting,"D:/R/imdikator-munch/data_flat_output/befolkning_flytting-bydel-2014.csv",row.names=F)
befolkning_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/befolkning_flytting_K_2014.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=",", dec=".",colClasses="character")
View(befolkning_flytting)
names(befolkning_flytting)[1] = "tabell_navn"
names(befolkning_flytting)[3] = "kommune_nr"
befolkning_flytting_vreg = subset(befolkning_flytting,invkat_2 =='innvandrere',select=-invkat_2)
befolkning_flytting_vreg$tabell_navn ="befolkning_flytting_vreg"
nlevels(as.factor(befolkning_flytting_vreg$kommune_nr))
3*428*9
nrow(befolkning_flytting_vreg)==3*nlevels(as.factor(befolkning_flytting_vreg$kommune_nr))*nlevels(as.factor(befolkning_flytting_vreg$flytting))
levels(as.factor(befolkning_flytting$flytting))
write.csv(befolkning_flytting_vreg,"D:/R/imdikator-munch/data_flat_output/befolkning_flytting_vreg-kommune-2014.csv",row.names=F)
befolkning_flytting=subset(befolkning_flytting,vreg_3 =='alle',select=-vreg_3)
df=spread(befolkning_flytting,invkat_2,tabellvariabel,drop=F)
View(df)
sum(is.na(df$alle))
sum(is.na(df$innvandrere))
df$befolkningen_ellers=extract_numeric(df[,6])-extract_numeric(df[,7])
sum(is.na(df$befolkningen_ellers))
befolkning_flytting=gather(df,innvkat_3,tabellvariabel,6:8,na.rm=F)
nrow(befolkning_flytting)==9*3*18
nrow(befolkning_flytting)==9*3*428
write.csv(befolkning_flytting,"D:/R/imdikator-munch/data_flat_output/befolkning_flytting-kommune-2014.csv",row.names=F)
befolkning_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/befolkning_flytting_N_2014.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=",", dec=".",colClasses="character")
View(befolkning_flytting)
names(befolkning_flytting)[1] = "tabell_navn"
names(befolkning_flytting)[3] = "naringsregion_nr"
levels(as.factor(befolkning_flytting$flytting))
befolkning_flytting_vreg = subset(befolkning_flytting,invkat_2 =='innvandrere',select=-invkat_2)
befolkning_flytting_vreg$tabell_navn ="befolkning_flytting_vreg"
nrow(befolkning_flytting_vreg)==3*nlevels(as.factor(befolkning_flytting_vreg$naringsregion_nr))*nlevels(as.factor(befolkning_flytting_vreg$flytting))
nrow(befolkning_flytting_vreg)==3*83*9
View(befolkning_flytting_vreg)
write.csv(befolkning_flytting_vreg,"D:/R/imdikator-munch/data_flat_output/befolkning_flytting_vreg-naringsregion-2014.csv",row.names=F)
befolkning_flytting=subset(befolkning_flytting,vreg_3 =='alle',select=-vreg_3)
df=spread(befolkning_flytting,invkat_2,tabellvariabel,drop=F)
sum(is.na(df$alle))
sum(is.na(df$innvandrere))
df$befolkningen_ellers=extract_numeric(df[,6])-extract_numeric(df[,7])
sum(is.na(df$befolkningen_ellers))
befolkning_flytting=gather(df,innvkat_3,tabellvariabel,6:8,na.rm=F)
nrow(befolkning_flytting)==9*3*428
nrow(befolkning_flytting)==9*3*83
write.csv(befolkning_flytting,"D:/R/imdikator-munch/data_flat_output/befolkning_flytting-naringsregion-2014.csv",row.names=F)
befolkning_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/befolkning_flytting_FL_2014.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=",", dec=".",colClasses="character")
View(befolkning_flytting)
names(befolkning_flytting)[1] = "tabell_navn"
names(befolkning_flytting)[3] = "fylke_nr"
befolkning_flytting$fylke_nr[nchar(befolkning_flytting$fylke_nr)==1] = paste0("0",befolkning_flytting$fylke_nr[nchar(befolkning_flytting$fylke_nr)==1])
levels(as.factor(befolkning_flytting$flytting))
befolkning_flytting_vreg = subset(befolkning_flytting,invkat_2 =='innvandrere',select=-invkat_2)
befolkning_flytting_vreg$tabell_navn ="befolkning_flytting_vreg"
#logisksjekk:
nrow(befolkning_flytting_vreg)==3*20*9
write.csv(befolkning_flytting_vreg,"D:/R/imdikator-munch/data_flat_output/befolkning_flytting_vreg-fylke-2014.csv",row.names=F)
befolkning_flytting=subset(befolkning_flytting,vreg_3 =='alle',select=-vreg_3)
df=spread(befolkning_flytting,invkat_2,tabellvariabel,drop=F)
View(df)
sum(is.na(df$alle))
sum(is.na(df$innvandrere))
df$befolkningen_ellers=extract_numeric(df[,6])-extract_numeric(df[,7])
sum(is.na(df$befolkningen_ellers))
befolkning_flytting=gather(df,innvkat_3,tabellvariabel,6:8,na.rm=F)
nrow(befolkning_flytting)==9*3*83
nrow(befolkning_flytting)==9*3*20
write.csv(befolkning_flytting,"D:/R/imdikator-munch/data_flat_output/befolkning_flytting-fylke-2014.csv",row.names=F)
flyktning_botid_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_B_2014.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=",", dec=".",colClasses="character")
flyktning_botid_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_B_2014.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=",", dec=".",colClasses="character")
flyktning_botid_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_B_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=",", dec=".",colClasses="character")
View(flyktning_botid_flytting)
View(flyktning_botid_flytting)
View(flyktning_botid_flytting)
flyktning_botid_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_B_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
flyktning_botid_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_B_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
View(flyktning_botid_flytting)
names(flyktning_botid_flytting)[3] = "bydel_nr"
flyktning_botid_flytting$bydel_nr[nchar(flyktning_botid_flytting$bydel_nr)==2] = paste0("0301",flyktning_botid_flytting$bydel_nr[nchar(flyktning_botid_flytting$bydel_nr)==2])
flyktning_botid_flytting = subset(flyktning_botid_flytting,select=-X)
levels(as.factor(flyktning_botid_flytting$botid_3))
levels(as.factor(flyktning_botid_flytting$forste_bosettingskommune))
flyktning_botid_flytting$botid_3 = gsub("\\-","_",flyktning_botid_flytting$botid_3)
levels(as.factor(flyktning_botid_flytting$botid_3))
levels(as.factor(flyktning_botid_flytting$forste_bosettingskommune))
3*4*18
3*4*18*2
3*4*18*2==nrow(flyktning_botid_flytting)
df=spread(flyktning_botid_flytting,botid_3,tabellvariabel,drop=F)
View(df)
46+25.2+28.8
df$alle_kopi=df$alle
df$alle=extract_numeric(df[,6])+extract_numeric(df[,7])
df$alle=as.numeric(df[,6])+as.numeric(df[,7])
flyktning_botid_flytting$tabellvariabel = gsub("\\,",".",flyktning_botid_flytting$tabellvariabel)
df=spread(flyktning_botid_flytting,botid_3,tabellvariabel,drop=F)
df$alle_kopi=df$alle
df$alle=extract_numeric(df[,6])+extract_numeric(df[,7])
sum(is.na(df$alle))
df = subset(df,select=-alle_kopi)
df_2=gather(df,botid_3,tabellvariabel,6:8,na.rm=F)
3*4*18*2
View(df_2)
write.csv(df2,"D:/R/imdikator-munch/data_flat_output/flyktning_botid_flytting-bydel-2015.csv",row.names=F)
write.csv(df_2,"D:/R/imdikator-munch/data_flat_output/flyktning_botid_flytting-bydel-2015.csv",row.names=F)
flyktning_botid_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_K_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
flyktning_botid_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_K_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
View(flyktning_botid_flytting)
names(flyktning_botid_flytting)[3] = "kommune_nr"
flyktning_botid_flytting = subset(flyktning_botid_flytting,select=-X)
levels(as.factor(flyktning_botid_flytting$botid_3))
levels(as.factor(flyktning_botid_flytting$forste_bosettingskommune))
flyktning_botid_flytting$botid_3 = gsub("\\-","_",flyktning_botid_flytting$botid_3)
flyktning_botid_flytting$tabellvariabel = gsub("\\,",".",flyktning_botid_flytting$tabellvariabel)
3*4*428*2
355+73
3*4*355*2
df=spread(flyktning_botid_flytting,botid_3,tabellvariabel,drop=F)
df$alle_kopi=df$alle
df$alle=extract_numeric(df[,6])+extract_numeric(df[,7])
sum(is.na(df$alle))
df = subset(df,select=-alle_kopi)
sum(is.na(df$alle))
3*4*355*2==nrow(flyktning_botid_flytting)
3*4*355*2
df_2=gather(df,botid_3,tabellvariabel,6:8,na.rm=F)
3*4*355*2
3*4*355*2==nrow(df_2)
df=spread(df_2,forste_bosettingskommune,tabellvariabel,drop=F)
sum(is.na(df$ja))
sum(is.na(df$nei))
sum(is.na(df$uoppgitt))
nlevels(as.factor(flyktning_botid_flytting$kommune_nr))
3*4*354*2==nrow(flyktning_botid_flytting)
3*4*354*2==nrow(df_2)
write.csv(df_2,"D:/R/imdikator-munch/data_flat_output/flyktning_botid_flytting-kommune-2015.csv",row.names=F)
flyktning_botid_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_N_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
flyktning_botid_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_N_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
View(flyktning_botid_flytting)
View(flyktning_botid_flytting)
names(flyktning_botid_flytting)[3] = "naringsregion_nr"
flyktning_botid_flytting = subset(flyktning_botid_flytting,select=-X)
levels(as.factor(flyktning_botid_flytting$botid_3))
levels(as.factor(flyktning_botid_flytting$forste_bosettingsnaringsregion))
levels(as.factor(flyktning_botid_flytting$forste_bosettingskommune))
flyktning_botid_flytting$botid_3 = gsub("\\-","_",flyktning_botid_flytting$botid_3)
flyktning_botid_flytting$tabellvariabel = gsub("\\,",".",flyktning_botid_flytting$tabellvariabel)
nlevels(as.factor(flyktning_botid_flytting$naringsregion_nr))
3*4*83*2==nrow(flyktning_botid_flytting)
3*4*83*2
df=spread(flyktning_botid_flytting,botid_3,tabellvariabel,drop=F)
df$alle_kopi=df$alle
df$alle=extract_numeric(df[,6])+extract_numeric(df[,7])
sum(is.na(df$alle))
df = subset(df,select=-alle_kopi)
sum(is.na(df$alle))
df_2=gather(df,botid_3,tabellvariabel,6:8,na.rm=F)
3*4*83*2==nrow(df_2)
write.csv(df_2,"D:/R/imdikator-munch/data_flat_output/flyktning_botid_flytting-naringsregion-2015.csv",row.names=F)
flyktning_botid_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_F_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
flyktning_botid_flytting_norge <- read.csv("D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_L_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
flyktning_botid_flytting = rbind (flyktning_botid_flytting,flyktning_botid_flytting_norge)
View(flyktning_botid_flytting)
names(flyktning_botid_flytting)[3] = "fylke_nr"
flyktning_botid_flytting = subset(flyktning_botid_flytting,select=-X)
levels(as.factor(flyktning_botid_flytting$botid_3))
levels(as.factor(flyktning_botid_flytting$forste_bosettingskommune))
flyktning_botid_flytting$botid_3 = gsub("\\-","_",flyktning_botid_flytting$botid_3)
flyktning_botid_flytting$tabellvariabel = gsub("\\,",".",flyktning_botid_flytting$tabellvariabel)
nlevels(as.factor(flyktning_botid_flytting$fylke_nr))
3*4*20*2
3*4*20*2==nrow(flyktning_botid_flytting)
df=spread(flyktning_botid_flytting,botid_3,tabellvariabel,drop=F)
df$alle_kopi=df$alle
df$alle=extract_numeric(df[,6])+extract_numeric(df[,7])
sum(is.na(df$alle))
df = subset(df,select=-alle_kopi)
sum(is.na(df$alle))
df_2=gather(df,botid_3,tabellvariabel,6:8,na.rm=F)
3*4*20*2==nrow(df_2)
write.csv(df_2,"D:/R/imdikator-munch/data_flat_output/flyktning_botid_flytting-fylke-2015.csv",row.names=F)
flyktning_botid_flytting$enhet(flyktning_botid_flytting$enhet=="person")
flyktning_botid_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_B_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
flyktning_botid_flytting$enhet(flyktning_botid_flytting$enhet=="person")
flyktning_botid_flytting$enhet[flyktning_botid_flytting$enhet=="person"]
flyktning_botid_flytting$enhet[flyktning_botid_flytting$enhet=="person"]="personer"
#FLYKTNING_BOTID_FLYTTING
flyktning_botid_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_B_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
# bydel_id må bli bydel_nr
# fjerne ekstra kolonne
# kode om 0-4 til 0_4
# bydeler må få 0301 foran
# logisk sjekk av antall observasjoner etter det
names(flyktning_botid_flytting)[3] = "bydel_nr"
flyktning_botid_flytting$bydel_nr[nchar(flyktning_botid_flytting$bydel_nr)==2] = paste0("0301",flyktning_botid_flytting$bydel_nr[nchar(flyktning_botid_flytting$bydel_nr)==2])
flyktning_botid_flytting$enhet[flyktning_botid_flytting$enhet=="person"]="personer"
flyktning_botid_flytting = subset(flyktning_botid_flytting,select=-X)
levels(as.factor(flyktning_botid_flytting$botid_3))
levels(as.factor(flyktning_botid_flytting$forste_bosettingskommune))
flyktning_botid_flytting$botid_3 = gsub("\\-","_",flyktning_botid_flytting$botid_3)
flyktning_botid_flytting$tabellvariabel = gsub("\\,",".",flyktning_botid_flytting$tabellvariabel)
3*4*18*2==nrow(flyktning_botid_flytting)
df=spread(flyktning_botid_flytting,botid_3,tabellvariabel,drop=F)
df$alle_kopi=df$alle
#problem med komma som desimaltegn, må gsubbes til punktum lenger opp
df$alle=extract_numeric(df[,6])+extract_numeric(df[,7])
df$alle=as.numeric(df[,6])+as.numeric(df[,7])
df = subset(df,select=-alle_kopi)
sum(is.na(df$alle))
df_2=gather(df,botid_3,tabellvariabel,6:8,na.rm=F)
write.csv(df_2,"D:/R/imdikator-munch/data_flat_output/flyktning_botid_flytting-bydel-2015.csv",row.names=F)
#FLYKTNING_BOTID_FLYTTING
#KOMMUNE
flyktning_botid_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_K_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
# kommune_id må bli kommune_nr
# fjerne ekstra kolonne
# kode om 0-4 til 0_4
#problem med komma som desimaltegn, må gsubbes til punktum lenger opp
# logisk sjekk av antall observasjoner etter det
names(flyktning_botid_flytting)[3] = "kommune_nr"
flyktning_botid_flytting$enhet[flyktning_botid_flytting$enhet=="person"]="personer"
flyktning_botid_flytting = subset(flyktning_botid_flytting,select=-X)
levels(as.factor(flyktning_botid_flytting$botid_3))
levels(as.factor(flyktning_botid_flytting$forste_bosettingskommune))
flyktning_botid_flytting$botid_3 = gsub("\\-","_",flyktning_botid_flytting$botid_3)
flyktning_botid_flytting$tabellvariabel = gsub("\\,",".",flyktning_botid_flytting$tabellvariabel)
nlevels(as.factor(flyktning_botid_flytting$kommune_nr))
3*4*354*2==nrow(flyktning_botid_flytting)
df=spread(flyktning_botid_flytting,botid_3,tabellvariabel,drop=F)
df$alle_kopi=df$alle
df$alle=extract_numeric(df[,6])+extract_numeric(df[,7])
sum(is.na(df$alle))
df = subset(df,select=-alle_kopi)
sum(is.na(df$alle))
df_2=gather(df,botid_3,tabellvariabel,6:8,na.rm=F)
3*4*354*2==nrow(df_2)
write.csv(df_2,"D:/R/imdikator-munch/data_flat_output/flyktning_botid_flytting-kommune-2015.csv",row.names=F)
#FLYKTNING_BOTID_FLYTTING
#NÆRINGSREGION
flyktning_botid_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_N_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
# naringsregion_id må bli naringsregion_nr
# fjerne ekstra kolonne
# kode om 0-4 til 0_4
#problem med komma som desimaltegn, må gsubbes til punktum lenger opp
# logisk sjekk av antall observasjoner etter det
names(flyktning_botid_flytting)[3] = "naringsregion_nr"
flyktning_botid_flytting$enhet[flyktning_botid_flytting$enhet=="person"]="personer"
flyktning_botid_flytting = subset(flyktning_botid_flytting,select=-X)
levels(as.factor(flyktning_botid_flytting$botid_3))
levels(as.factor(flyktning_botid_flytting$forste_bosettingskommune))
flyktning_botid_flytting$botid_3 = gsub("\\-","_",flyktning_botid_flytting$botid_3)
flyktning_botid_flytting$tabellvariabel = gsub("\\,",".",flyktning_botid_flytting$tabellvariabel)
nlevels(as.factor(flyktning_botid_flytting$naringsregion_nr))
3*4*83*2==nrow(flyktning_botid_flytting)
df=spread(flyktning_botid_flytting,botid_3,tabellvariabel,drop=F)
df$alle_kopi=df$alle
df$alle=extract_numeric(df[,6])+extract_numeric(df[,7])
sum(is.na(df$alle))
df = subset(df,select=-alle_kopi)
sum(is.na(df$alle))
df_2=gather(df,botid_3,tabellvariabel,6:8,na.rm=F)
3*4*83*2==nrow(df_2)
write.csv(df_2,"D:/R/imdikator-munch/data_flat_output/flyktning_botid_flytting-naringsregion-2015.csv",row.names=F)
#FLYKTNING_BOTID_FLYTTING
#FYLKE
flyktning_botid_flytting <- read.csv("D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_F_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
flyktning_botid_flytting_norge <- read.csv("D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_L_2015.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
flyktning_botid_flytting = rbind (flyktning_botid_flytting,flyktning_botid_flytting_norge)
# fylke_id må bli fylke_nr
# fjerne ekstra kolonne
# kode om 0-4 til 0_4
#problem med komma som desimaltegn, må gsubbes til punktum lenger opp
# logisk sjekk av antall observasjoner etter det
names(flyktning_botid_flytting)[3] = "fylke_nr"
flyktning_botid_flytting$enhet[flyktning_botid_flytting$enhet=="person"]="personer"
flyktning_botid_flytting = subset(flyktning_botid_flytting,select=-X)
levels(as.factor(flyktning_botid_flytting$botid_3))
levels(as.factor(flyktning_botid_flytting$forste_bosettingskommune))
flyktning_botid_flytting$botid_3 = gsub("\\-","_",flyktning_botid_flytting$botid_3)
flyktning_botid_flytting$tabellvariabel = gsub("\\,",".",flyktning_botid_flytting$tabellvariabel)
nlevels(as.factor(flyktning_botid_flytting$fylke_nr))
3*4*20*2==nrow(flyktning_botid_flytting)
df=spread(flyktning_botid_flytting,botid_3,tabellvariabel,drop=F)
df$alle_kopi=df$alle
df$alle=extract_numeric(df[,6])+extract_numeric(df[,7])
sum(is.na(df$alle))
df = subset(df,select=-alle_kopi)
sum(is.na(df$alle))
df_2=gather(df,botid_3,tabellvariabel,6:8,na.rm=F)
3*4*20*2==nrow(df_2)
write.csv(df_2,"D:/R/imdikator-munch/data_flat_output/flyktning_botid_flytting-fylke-2015.csv",row.names=F)
sosialhjelp <- read.csv("D:/R/imdikator-munch/data_flat_input/sosialhjelp_2013-2014.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
sosialhjelp <- read.csv("D:/R/imdikator-munch/data_flat_input/sosialhjelp_2013-2014.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=",", dec=".",colClasses="character")
View(sosialhjelp)
levels(as.factor(names(sosialhjelp)))
levels(as.factor(sosialhjelp))
levels(as.factor(sosialhjelp$aar))
levels(as.factor(sosialhjelp[,2:3))
levels(as.factor(sosialhjelp[,2:3]))
levels(as.factor(sosialhjelp$kommune_nr))
levels(as.factor(sosialhjelp$fylke_nr))
levels(as.factor(sosialhjelp$bydel_nr))
levels(as.factor(sosialhjelp$naringsregion_nr))
sosialhjelp$fylke_nr[sosialhjelp$fylke_nr=="0"]="00"
levels(as.factor(sosialhjelp$fylke_nr))
flyktning_botid_flytting$enhet[flyktning_botid_flytting$enhet=="person"]="personer"
sosialhjelp$enhet[sosialhjelp$enhet=="person"]="personer"
nlevels(as.factor(sosialhjelp$fylke_nr))
nlevels(as.factor(sosialhjelp$bydel_nr))
nlevels(as.factor(sosialhjelp$kommune_nr))-1
nlevels(as.factor(sosialhjelp$naringsregion_nr))-1
nlevels(as.factor(sosialhjelp$fylke_nr))-1
(18*3*3*2)+(428*3*3*2)+(83*3*3*2)+(20*3*3*2)
nlevels(as.factor(sosialhjelp$bydel_nr))-1
nlevels(as.factor(sosialhjelp$kommune_nr))-1
nlevels(as.factor(sosialhjelp$naringsregion_nr))-1
nlevels(as.factor(sosialhjelp$fylke_nr))-1
(18*3*3*2)+(428*3*3*2)+(83*3*3*2)+(20*3*3*2)
(18*3*3*2*2)+(428*3*3*2*2)+(83*3*3*2*2)+(20*3*3*2*2)
nrow(sosialhjelp)==(18*3*3*2*2)+(428*3*3*2*2)+(83*3*3*2*2)+(20*3*3*2*2)
write.csv(sosialhjelp,"D:/R/imdikator-munch/data_flat_output/sosialhjelp-alle-2013_2014.csv",row.names=F)
grunnskolepoeng <- read.csv("D:/R/imdikator-munch/data_flat_input/grunnskolepoeng_bydel_2014_ny.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=",", dec=".",colClasses="character")
View(grunnskolepoeng)
grunnskolepoeng <- read.csv("D:/R/imdikator-munch/data_flat_input/grunnskolepoeng_bydel_2014_ny.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
View(grunnskolepoeng)
grunnskolepoeng$aar[grunnskolepoeng$aar=="2013-2014"]="2014"
grunnskolepoeng$aar[grunnskolepoeng$aar=="2014-2015"]="2015"
grunnskolepoeng <- read.csv("D:/R/imdikator-munch/data_flat_input/grunnskolepoeng_bydel_2014_ny.csv", row.names=NULL, na.strings="NA", stringsAsFactors=FALSE, sep=";", dec=",",colClasses="character")
levels(as.factor(grunnskolepoeng$aar))
grunnskolepoeng$enhet[grunnskolepoeng$enhet=="person"]="personer"
grunnskolepoeng$aar[grunnskolepoeng$aar=="2013-2014"]="2014"
18*3*5*4*4
df=spread(grunnskolepoeng,kjonn,tabellvariabel,drop=F)
library(tidyr)
df=spread(grunnskolepoeng,kjonn,tabellvariabel,drop=F)
View(df)
df=spread(grunnskolepoeng,innvkat_5,tabellvariabel,drop=F)
df=spread(grunnskolepoeng,vreg_3,tabellvariabel,drop=F)
df=spread(grunnskolepoeng,innvalder_3,tabellvariabel,drop=F)
df=spread(grunnskolepoeng,invalder_3,tabellvariabel,drop=F)
df=spread(grunnskolepoeng,innvkat_5,tabellvariabel,drop=F)
