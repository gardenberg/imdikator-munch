{
    "contents" : "#SCRIPT FOR KONVERTERING TIL FLATFIL\n#Todo: \n#test av tidy-pakke på indikatordata\nlibrary(tidyr)\n\ntest <- read.csv(\"training_files/04-befolkning_alder-bydel-2014.csv\", header=FALSE, row.names=NULL, sep=\";\", na.strings = c(\"NA\",\".\",\":\"),stringsAsFactors = F)\n\n#tilnærming: multiple variables stored in one column\n#steg 1: samle verdier til en kolonnetittel\ndataHead = data.frame(test[1:4,])\ndataHead = data.frame(t(dataHead))\nnavn = colnames(dataHead)\ndataHead$kode <- do.call(paste, c(dataHead[navn], sep=\"-\"))\ndataHead = data.frame(t(dataHead))\n\n#STEG 2:setter inn en ny rad på et spesifisert sted og fjerner øverste rader\nover_kutt=4\ntestDF <- rbind(test[1:over_kutt,],dataHead[5,],test[-(1:over_kutt),])\ncolnames(testDF)=testDF[5,]\ntestDF=testDF[6:24,]\n\n#rydder slik at første kolonne inneholder riktige rownames og fjerner overflødige kolonner\n#bydel må være en variabel på linje med de andre, må legges inn over-.\ntestDF=testDF[,2:66]\ntestDF=subset(testDF,select=-`Bydel\\nnavn---`)\n\n#STEG 3: Split\n#samler alt opp først\ntemp_a=names(testDF[1])\nsamlaDF=gather(data=testDF,variabler,verdier,-`bydel_nr---`)\n\n#splitter så opp. må gjøres posisjonsvis.\nsplitDF=separate(samlaDF,variabler,c(\"innvkat\",\"alder_grupper\",\"kjonn\",\"enhet\"),\"-\")\n\n#splitter verdiene\nsplitDF=separate(splitDF,innvkat,c(\"variabel\",\"innvkat_3\"),\"\\\\.\")\nsplitDF=separate(splitDF,alder_grupper,c(\"variabel\",\"alder_grupper\"),\"\\\\.\")\nsplitDF=separate(splitDF,kjonn,c(\"variabel\",\"kjonn\"),\"\\\\.\")\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),\"\\\\.\")\n\nsplitDF[,1]\n#ferdig DF\nferdigDF=data.frame(splitDF[,1],splitDF$innvkat_3,splitDF$alder_grupper,splitDF$kjonn,splitDF$enhet,splitDF$verdier)\ncolnames(ferdigDF)=c(\"bydel_nr\",\"innvkat_3\",\"alder_grupper_5\",\"kjonn\",\"enhet\",\"tabellvariabel\")\n\n#test mot benglers konverterte flatfil\nlibrary(dplyr)\nkontroll_1 <- read.csv(\"data/befolkning_alder.csv\", header=T, row.names=NULL, sep=\",\", na.strings = \"NA\",stringsAsFactors = F)\nkontroll_2=subset(kontroll_1,subset=bydel_nr!=\"NULL\",select=c(-fylke_nr,-kommune_nr,-naringsregion_nr,-tabell_navn,-aar))\nkontroll_3=anti_join(kontroll_2,ferdigDF)\n\n#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE\n#BYDEL 2013\n#23. oktober 2015\nlibrary(tidyr)\n\n#30. oktober: MASSIVE FEIL OPPDAGA - LAGER 36 DUPLIKATER AV DATASETTET\n#TRENGER FEILSIKRING MOT DETTE!\n\n#feil: brukte na.strings, overskriver \".\" og \":\".\nbarnehagedeltakelse <- read.csv(\"data_crossed_input/30-barnehagedeltakelse-bydel-2013.csv\", header=T, row.names=NULL, sep=\";\", dec=\",\",stringsAsFactors = F)\n#tilnærming: multiple variables stored in one column\n#steg 1: samle verdier til en kolonnetittel\n#gjort i excel\n#STEG 2:setter inn en ny rad på et spesifisert sted og fjerner øverste rader\n#gjort i excel\n#STEG 3: Split\n#samler alt opp først. \nsamlaDF_1=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with(\"barnikommune\")))\nsamlaDF_1 = subset(samlaDF_1,select = c(1,variabler,tabellvariabel))\nsamlaDF_2=gather(data=barnehagedeltakelse,variabler,tabellvariabel,starts_with(\"barnikommune\"))\nsamlaDF_2 = subset(samlaDF_2,select = c(1,variabler,tabellvariabel))\n\n#er det introdusert NA? erstatt i så fall med \".\"\nsum(is.na(samlaDF_1$tabellvariabel))\nsum(is.na(samlaDF_2$tabellvariabel))\n#fjernet - NA-erstatting er gjort av SSB pre-processing\n#lager to df, en med barnikommune og en med spraak\n\n#sjekk av duplikate linjer\n#bør ha en logisk test av at riktig antall kombinasjoner er med\n#18 bydeler*72 ulike variabler delt på to sett med spraak og barnikkomune\nif(nrow(samlaDF_1)>((nrow(barnehagedeltakelse)*(ncol(barnehagedeltakelse)-1)/2))){\n        testDF_1=unique(samlaDF_1)\n}\nif(nrow(samlaDF_2)>((nrow(barnehagedeltakelse)*(ncol(barnehagedeltakelse)-1)/2))){\n        testDF_2=unique(samlaDF_2)\n}\n\n#splitter så opp. må gjøres posisjonsvis. SPRAAK FØRST\n#bruk av _ som separator i variabelnavn gir trøbbel, \nsplitDF=separate(samlaDF_1,variabler,c(\"spraak\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraak,c(\"variabel\",\"spraak\"),7)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\n#erstatter nye tegn\nsplitDF$bydel_nr[splitDF$bydel_nr<99999]=paste0(\"0\",splitDF$bydel_nr)\nsplitDF$spraak = gsub(\"\\\\.\",\"_\",splitDF$spraak)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\n#legger til øvrige nødvendige verdier\nsplitDF$aar = \"2013\"\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/barnehagedeltakelse_spraak-bydel-2013.csv\",row.names=F)\n#BHGALDER\n#bruk av _ som separator i variabelnavn gir trøbbel, \nsplitDF=separate(samlaDF_2,variabler,c(\"barnikommune\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,barnikommune,c(\"variabel\",\"barnikommune\"),(nchar(\"barnikommume\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\n#erstatter nye tegn\nsplitDF$bydel_nr[splitDF$bydel_nr<99999]=paste0(\"0\",splitDF$bydel_nr)\nsplitDF$barnikommune = gsub(\"\\\\.\",\"_\",splitDF$barnikommune)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\n#legger til øvrige nødvendige verdier\nsplitDF$aar = \"2013\"\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\n#skriver ut fil\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/barnehagedeltakelse_barnikommune-bydel-2013.csv\",row.names=F)\n\n#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - BYDEL2014\nbarnehagedeltakelse <- read.csv(\"data_crossed_input/30-barnehagedeltakelse-bydel-2014.csv\", header=T, row.names=NULL, sep=\";\", dec=\",\", stringsAsFactors = F)\n\nsamlaDF_1=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with(\"barnikommune\")))\nsamlaDF_1 = subset(samlaDF_1,select = c(1,variabler,tabellvariabel))\nsamlaDF_2=gather(data=barnehagedeltakelse,variabler,tabellvariabel,starts_with(\"barnikommune\"))\nsamlaDF_2 = subset(samlaDF_2,select = c(1,variabler,tabellvariabel))\n#sjekk av duplikate linjer\nif(nrow(samlaDF_1)>((nrow(barnehagedeltakelse)*(ncol(barnehagedeltakelse)-1)/2))){\n        testDF_1=unique(samlaDF_1)\n}\nif(nrow(samlaDF_2)>((nrow(barnehagedeltakelse)*(ncol(barnehagedeltakelse)-1)/2))){\n        testDF_2=unique(samlaDF_2)\n}\n\n#SPRAAK\nsplitDF=separate(samlaDF_1,variabler,c(\"spraak\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraak,c(\"variabel\",\"spraak\"),7)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$bydel_nr[splitDF$bydel_nr<99999]=paste0(\"0\",splitDF$bydel_nr)\nsplitDF$spraak = gsub(\"\\\\.\",\"_\",splitDF$spraak)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = \"2014\"\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/barnehagedeltakelse_spraak-bydel-2014.csv\",row.names=F)\n#BHGALDER\nsplitDF=separate(samlaDF_2,variabler,c(\"barnikommune\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,barnikommune,c(\"variabel\",\"barnikommune\"),(nchar(\"barnikommume\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$bydel_nr[splitDF$bydel_nr<99999]=paste0(\"0\",splitDF$bydel_nr)\nsplitDF$barnikommune = gsub(\"\\\\.\",\"_\",splitDF$barnikommune)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = \"2014\"\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/barnehagedeltakelse_barnikommune-bydel-2014.csv\",row.names=F)\n\n#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - FYLKE2013\nbarnehagedeltakelse <- read.csv(\"data_crossed_input/30-barnehagedeltakelse-fylke-2013.csv\", header=T, row.names=NULL, sep=\";\", dec=\",\",stringsAsFactors = F)\nsamlaDF_1=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with(\"barnikommune\")))\nsamlaDF_1 = subset(samlaDF_1,select = c(1,variabler,tabellvariabel))\nsamlaDF_2=gather(data=barnehagedeltakelse,variabler,tabellvariabel,starts_with(\"barnikommune\"))\nsamlaDF_2 = subset(samlaDF_2,select = c(1,variabler,tabellvariabel))\n#sjekk av duplikate linjer\nif(nrow(samlaDF_1)>((nrow(barnehagedeltakelse)*(ncol(barnehagedeltakelse)-1)/2))){\n        testDF_1=unique(samlaDF_1)\n}\nif(nrow(samlaDF_2)>((nrow(barnehagedeltakelse)*(ncol(barnehagedeltakelse)-1)/2))){\n        testDF_2=unique(samlaDF_2)\n}#SPRAAK\nsplitDF=separate(samlaDF_1,variabler,c(\"spraak\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraak,c(\"variabel\",\"spraak\"),7)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0(\"0\",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])\nsplitDF$spraak = gsub(\"\\\\.\",\"_\",splitDF$spraak)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = \"2013\"\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/barnehagedeltakelse_spraak-fylke-2013.csv\",row.names=F)\n#BHGALDER\nsplitDF=separate(samlaDF_2,variabler,c(\"barnikommune\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,barnikommune,c(\"variabel\",\"barnikommune\"),(nchar(\"barnikommume\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0(\"0\",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])\nsplitDF$barnikommune = gsub(\"\\\\.\",\"_\",splitDF$barnikommune)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = \"2013\"\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/barnehagedeltakelse_barnikommune-fylke-2013.csv\",row.names=F)\n\n#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - FYLKE2014\nbarnehagedeltakelse <- read.csv(\"data_crossed_input/30-barnehagedeltakelse-fylke-2014.csv\", header=T, row.names=NULL, sep=\";\", dec=\",\",stringsAsFactors = F)\nsamlaDF_1=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with(\"barnikommune\")))\nsamlaDF_1 = subset(samlaDF_1,select = c(1,variabler,tabellvariabel))\nsamlaDF_2=gather(data=barnehagedeltakelse,variabler,tabellvariabel,starts_with(\"barnikommune\"))\nsamlaDF_2 = subset(samlaDF_2,select = c(1,variabler,tabellvariabel))\n#sjekk av duplikate linjer\nif(nrow(samlaDF_1)>((nrow(barnehagedeltakelse)*(ncol(barnehagedeltakelse)-1)/2))){\n        testDF_1=unique(samlaDF_1)\n}\nif(nrow(samlaDF_2)>((nrow(barnehagedeltakelse)*(ncol(barnehagedeltakelse)-1)/2))){\n        testDF_2=unique(samlaDF_2)\n}\n#SPRAAK\nsplitDF=separate(samlaDF_1,variabler,c(\"spraak\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraak,c(\"variabel\",\"spraak\"),7)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0(\"0\",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])\nsplitDF$spraak = gsub(\"\\\\.\",\"_\",splitDF$spraak)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = \"2014\"\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/barnehagedeltakelse_spraak-fylke-2014.csv\",row.names=F)\n#BHGALDER\nsplitDF=separate(samlaDF_2,variabler,c(\"barnikommune\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,barnikommune,c(\"variabel\",\"barnikommune\"),(nchar(\"barnikommume\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0(\"0\",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])\nsplitDF$barnikommune = gsub(\"\\\\.\",\"_\",splitDF$barnikommune)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = \"2014\"\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/barnehagedeltakelse_barnikommune-fylke-2014.csv\",row.names=F)\n\n#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - KOMMUNE2013\nbarnehagedeltakelse <- read.csv(\"data_crossed_input/30-barnehagedeltakelse-kommune-2013.csv\", header=T, row.names=NULL, sep=\";\", dec=\",\", stringsAsFactors = F)\nsamlaDF_1=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with(\"barnikommune\")))\nsamlaDF_1 = subset(samlaDF_1,select = c(1,variabler,tabellvariabel))\nsamlaDF_2=gather(data=barnehagedeltakelse,variabler,tabellvariabel,starts_with(\"barnikommune\"))\nsamlaDF_2 = subset(samlaDF_2,select = c(1,variabler,tabellvariabel))\n#sjekk av duplikate linjer\nif(nrow(samlaDF_1)>((nrow(barnehagedeltakelse)*(ncol(barnehagedeltakelse)-1)/2))){\n        testDF_1=unique(samlaDF_1)\n}\nif(nrow(samlaDF_2)>((nrow(barnehagedeltakelse)*(ncol(barnehagedeltakelse)-1)/2))){\n        testDF_2=unique(samlaDF_2)\n}\n#SPRAAK\nsplitDF=separate(samlaDF_1,variabler,c(\"spraak\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraak,c(\"variabel\",\"spraak\"),7)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$kommune_nr[nchar(splitDF$kommune_nr)==3] = paste0(\"0\",splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3])\nsplitDF$spraak = gsub(\"\\\\.\",\"_\",splitDF$spraak)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = \"2013\"\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/barnehagedeltakelse_spraak-kommune-2013.csv\",row.names=F)\n#BHGALDER\nsplitDF=separate(samlaDF_2,variabler,c(\"barnikommune\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,barnikommune,c(\"variabel\",\"barnikommune\"),(nchar(\"barnikommume\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$kommune_nr[nchar(splitDF$kommune_nr)==3] = paste0(\"0\",splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3])\nsplitDF$barnikommune = gsub(\"\\\\.\",\"_\",splitDF$barnikommune)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = \"2013\"\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/barnehagedeltakelse_barnikommune-kommune-2013.csv\",row.names=F)\n\n#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - KOMMUNE2014\nbarnehagedeltakelse <- read.csv(\"data_crossed_input/30-barnehagedeltakelse-kommune-2014.csv\", header=T, row.names=NULL, sep=\";\", dec=\",\", stringsAsFactors = F)\nsamlaDF_1=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with(\"barnikommune\")))\nsamlaDF_1 = subset(samlaDF_1,select = c(1,variabler,tabellvariabel))\nsamlaDF_2=gather(data=barnehagedeltakelse,variabler,tabellvariabel,starts_with(\"barnikommune\"))\nsamlaDF_2 = subset(samlaDF_2,select = c(1,variabler,tabellvariabel))\n#sjekk av duplikate linjer\nif(nrow(samlaDF_1)>((nrow(barnehagedeltakelse)*(ncol(barnehagedeltakelse)-1)/2))){\n        testDF_1=unique(samlaDF_1)\n}\nif(nrow(samlaDF_2)>((nrow(barnehagedeltakelse)*(ncol(barnehagedeltakelse)-1)/2))){\n        testDF_2=unique(samlaDF_2)\n}\n#SPRAAK\nsplitDF=separate(samlaDF_1,variabler,c(\"spraak\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraak,c(\"variabel\",\"spraak\"),7)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$kommune_nr[nchar(splitDF$kommune_nr)==3] = paste0(\"0\",splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3])\nsplitDF$spraak = gsub(\"\\\\.\",\"_\",splitDF$spraak)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = \"2014\"\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/barnehagedeltakelse_spraak-kommune-2014.csv\",row.names=F)\n#BHGALDER\nsplitDF=separate(samlaDF_2,variabler,c(\"barnikommune\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,barnikommune,c(\"variabel\",\"barnikommune\"),(nchar(\"barnikommume\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$kommune_nr[nchar(splitDF$kommune_nr)==3] = paste0(\"0\",splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3])\nsplitDF$barnikommune = gsub(\"\\\\.\",\"_\",splitDF$barnikommune)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = \"2014\"\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/barnehagedeltakelse_barnikommune-kommune-2014.csv\",row.names=F)\n\n#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - NÆRINGSREGION2013\nbarnehagedeltakelse <- read.csv(\"data_crossed_input/30-barnehagedeltakelse-naringsregion-2013.csv\", header=T, row.names=NULL, sep=\";\", dec=\",\", stringsAsFactors = F)\nsamlaDF_1=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with(\"barnikommune\")))\nsamlaDF_1 = subset(samlaDF_1,select = c(1,variabler,tabellvariabel))\nsamlaDF_2=gather(data=barnehagedeltakelse,variabler,tabellvariabel,starts_with(\"barnikommune\"))\nsamlaDF_2 = subset(samlaDF_2,select = c(1,variabler,tabellvariabel))\n#sjekk av duplikate linjer\nif(nrow(samlaDF_1)>((nrow(barnehagedeltakelse)*(ncol(barnehagedeltakelse)-1)/2))){\n        testDF_1=unique(samlaDF_1)\n}\nif(nrow(samlaDF_2)>((nrow(barnehagedeltakelse)*(ncol(barnehagedeltakelse)-1)/2))){\n        testDF_2=unique(samlaDF_2)\n}\n#SPRAAK\nsplitDF=separate(samlaDF_1,variabler,c(\"spraak\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraak,c(\"variabel\",\"spraak\"),7)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1] = paste0(\"0\",splitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1])\nsplitDF$spraak = gsub(\"\\\\.\",\"_\",splitDF$spraak)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = \"2013\"\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/barnehagedeltakelse_spraak-naringsregion-2013.csv\",row.names=F)\n#BHGALDER\nsplitDF=separate(samlaDF_2,variabler,c(\"barnikommune\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,barnikommune,c(\"variabel\",\"barnikommune\"),(nchar(\"barnikommume\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1] = paste0(\"0\",splitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1])\nsplitDF$barnikommune = gsub(\"\\\\.\",\"_\",splitDF$barnikommune)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = \"2013\"\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/barnehagedeltakelse_barnikommune-naringsregion-2013.csv\",row.names=F)\n\n#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - NÆRINGSREGION2014\nbarnehagedeltakelse <- read.csv(\"data_crossed_input/30-barnehagedeltakelse-naringsregion-2014.csv\", header=T, row.names=NULL, sep=\";\", dec=\",\", stringsAsFactors = F)\nsamlaDF_1=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with(\"barnikommune\")))\nsamlaDF_1 = subset(samlaDF_1,select = c(1,variabler,tabellvariabel))\nsamlaDF_2=gather(data=barnehagedeltakelse,variabler,tabellvariabel,starts_with(\"barnikommune\"))\nsamlaDF_2 = subset(samlaDF_2,select = c(1,variabler,tabellvariabel))\n#sjekk av duplikate linjer\nif(nrow(samlaDF_1)>((nrow(barnehagedeltakelse)*(ncol(barnehagedeltakelse)-1)/2))){\n        testDF_1=unique(samlaDF_1)\n}\nif(nrow(samlaDF_2)>((nrow(barnehagedeltakelse)*(ncol(barnehagedeltakelse)-1)/2))){\n        testDF_2=unique(samlaDF_2)\n}\n#SPRAAK\nsplitDF=separate(samlaDF_1,variabler,c(\"spraak\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraak,c(\"variabel\",\"spraak\"),7)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1] = paste0(\"0\",splitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1])\nsplitDF$spraak = gsub(\"\\\\.\",\"_\",splitDF$spraak)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = \"2014\"\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/barnehagedeltakelse_spraak-naringsregion-2014.csv\",row.names=F)\n#BHGALDER\nsplitDF=separate(samlaDF_2,variabler,c(\"barnikommune\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,barnikommune,c(\"variabel\",\"barnikommune\"),(nchar(\"barnikommume\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1] = paste0(\"0\",splitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1])\nsplitDF$barnikommune = gsub(\"\\\\.\",\"_\",splitDF$barnikommune)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = \"2014\"\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/barnehagedeltakelse_barnikommune-naringsregion-2014.csv\",row.names=F)\n\n#NORSKPRØVER - RESULTATER - FYLKE 1. halvår 2014\nnorsk_prover <- read.csv(\"D:/R/imdikator-munch/data_crossed_input/norsk_prover-fylke-halvar2014.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\nsamlaDF=gather(data=norsk_prover,variabler,tabellvariabel,-1)\nsum(is.na(samlaDF$tabellvariabel))\nsplitDF=separate(samlaDF,variabler,c(\"spraaknivaa\",\"provetype\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraaknivaa,c(\"variabel\",\"spraaknivaa\"),(nchar(\"spraaknivaa\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,provetype,c(\"variabel\",\"provetype\"),(nchar(\"provetype\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0(\"0\",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])\nsplitDF$spraaknivaa = gsub(\"\\\\.\",\"_\",splitDF$spraaknivaa)\nsplitDF$provetype = gsub(\"\\\\.\",\"_\",splitDF$provetype)\nsplitDF$aar = \"2014\"\nsplitDF$tabell_navn = \"norsk_prover\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/norsk_prover-fylke-2014.csv\",row.names=F)\n\nlevels(as.factor(splitDF$aar))\n\n#NORSKPRØVER - RESULTATER - KOMMUNE 1. halvår 2014\nnorsk_prover <- read.csv(\"D:/R/imdikator-munch/data_crossed_input/norsk_prover-kommune-halvar2014.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\nsamlaDF=gather(data=norsk_prover,variabler,tabellvariabel,-1)\nsum(is.na(samlaDF$tabellvariabel))\n#testDF = subset(samlaDF,is.na(tabellvariabel)==T)\nsplitDF=separate(samlaDF,variabler,c(\"spraaknivaa\",\"provetype\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraaknivaa,c(\"variabel\",\"spraaknivaa\"),(nchar(\"spraaknivaa\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,provetype,c(\"variabel\",\"provetype\"),(nchar(\"provetype\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$kommune_nr[nchar(splitDF$kommune_nr)==3] = paste0(\"0\",splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3])\nsplitDF$spraaknivaa = gsub(\"\\\\.\",\"_\",splitDF$spraaknivaa)\nsplitDF$provetype = gsub(\"\\\\.\",\"_\",splitDF$provetype)\nsplitDF$aar = 2014\nsplitDF$tabell_navn = \"norsk_prover\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/norsk_prover-kommune-2014.csv\",row.names=F)\n\n#INTRO_STATUS_ARBUTD - FYLKE\n#27. okt, kjørt på nytt 17. nov\nlibrary(tidyr)\nintro_status_arbutd <- read.csv(\"D:/R/imdikator-munch/data_crossed_input/intro_status_arbutd-fylke-2011_2013.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE,colClasses = \"character\")\nsamlaDF=gather(data=intro_status_arbutd,variabler,tabellvariabel,-1)\nsum(is.na(samlaDF$tabellvariabel))\nsplitDF=separate(samlaDF,variabler,c(\"avslutta\",\"kjonn\",\"avslstat4\",\"aar\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,avslutta,c(\"variabel\",\"avslutta\"),(nchar(\"avslutta\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,kjonn,c(\"variabel\",\"kjonn\"),(nchar(\"kjonn\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,avslstat4,c(\"variabel\",\"avslstat4\"),(nchar(\"avslutning.status.4\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,aar,c(\"variabel\",\"aar\"),(nchar(\"aar\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),(nchar(\"enhet\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0(\"0\",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])\nsplitDF$avslutta = gsub(\"\\\\.\",\"_\",splitDF$avslutta)\nsplitDF$kjonn = gsub(\"\\\\.\",\"_\",splitDF$kjonn)\nsplitDF$avslstat4 = gsub(\"\\\\.\",\"_\",splitDF$avslstat4)\nsplitDF$aar = gsub(\"\\\\.\",\"_\",splitDF$aar)\nsplitDF$enhet = gsub(\"\\\\.\",\"_\",splitDF$enhet)\nsplitDF$tabell_navn = \"intro_status_arbutd\"\n\nlevels(as.factor(splitDF$avslstat4))\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/intro_status_arbutd-fylke-2011_2013.csv\",row.names=F)\n\n#INTRO_STATUS_ARBUTD - KOMMUNE\n#29. okt\nlibrary(tidyr)\nintro_status_arbutd <- read.csv(\"D:/R/imdikator-munch/data_crossed_input/intro_status_arbutd-kommune-2011_2013.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE,colClasses = \"character\")\nsamlaDF=gather(data=intro_status_arbutd,variabler,tabellvariabel,-1)\nsum(is.na(samlaDF$tabellvariabel))\nsplitDF=separate(samlaDF,variabler,c(\"avslutta\",\"kjonn\",\"avslstat4\",\"aar\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,avslutta,c(\"variabel\",\"avslutta\"),(nchar(\"avslutta\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,kjonn,c(\"variabel\",\"kjonn\"),(nchar(\"kjonn\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,avslstat4,c(\"variabel\",\"avslstat4\"),(nchar(\"avslutning.status.4\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,aar,c(\"variabel\",\"aar\"),(nchar(\"aar\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),(nchar(\"enhet\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$kommune_nr[nchar(splitDF$kommune_nr)==3] = paste0(\"0\",splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3])\nsplitDF$avslutta = gsub(\"\\\\.\",\"_\",splitDF$avslutta)\nsplitDF$kjonn = gsub(\"\\\\.\",\"_\",splitDF$kjonn)\nsplitDF$avslstat4 = gsub(\"\\\\.\",\"_\",splitDF$avslstat4)\nsplitDF$aar = gsub(\"\\\\.\",\"_\",splitDF$aar)\nsplitDF$enhet = gsub(\"\\\\.\",\"_\",splitDF$enhet)\nsplitDF$tabell_navn = \"intro_status_arbutd\"\nlevels(as.factor(splitDF$avslstat4))\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/intro_status_arbutd-kommune-2011_2013.csv\",row.names=F)\n\n#INTRO_STATUS_ARBUTD - BYDEL\n#29. okt\nlibrary(tidyr)\nintro_status_arbutd <- read.csv(\"D:/R/imdikator-munch/data_crossed_input/intro_status_arbutd-bydel-2011_2013.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE,colClasses = \"character\")\nsamlaDF=gather(data=intro_status_arbutd,variabler,tabellvariabel,-1)\nsum(is.na(samlaDF$tabellvariabel))\nsplitDF=separate(samlaDF,variabler,c(\"avslutta\",\"kjonn\",\"avslstat4\",\"aar\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,avslutta,c(\"variabel\",\"avslutta\"),(nchar(\"avslutta\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,kjonn,c(\"variabel\",\"kjonn\"),(nchar(\"kjonn\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,avslstat4,c(\"variabel\",\"avslstat4\"),(nchar(\"avslutning.status.4\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,aar,c(\"variabel\",\"aar\"),(nchar(\"aar\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),(nchar(\"enhet\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$bydel_nr[nchar(splitDF$bydel_nr)==5] = paste0(\"0\",splitDF$bydel_nr[nchar(splitDF$bydel_nr)==5])\nsplitDF$bydel_nr[nchar(splitDF$bydel_nr)==3] = paste0(\"0\",splitDF$bydel_nr[nchar(splitDF$bydel_nr)==3])\nsplitDF$avslutta = gsub(\"\\\\.\",\"_\",splitDF$avslutta)\nsplitDF$kjonn = gsub(\"\\\\.\",\"_\",splitDF$kjonn)\nsplitDF$avslstat4 = gsub(\"\\\\.\",\"_\",splitDF$avslstat4)\nsplitDF$aar = gsub(\"\\\\.\",\"_\",splitDF$aar)\nsplitDF$enhet = gsub(\"\\\\.\",\"_\",splitDF$enhet)\nsplitDF$tabell_navn = \"intro_status_arbutd\"\nlevels(as.factor(splitDF$avslstat4))\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/intro_status_arbutd-bydel-2011_2013.csv\",row.names=F)\n\n#INTRO_STATUS_ARBUTD - NÆRINGSREGION\n#17. nov\nlibrary(tidyr)\nintro_status_arbutd <- read.csv(\"D:/R/imdikator-munch/data_crossed_input/intro_status_arbutd-naringsregion-2011_2013.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE,colClasses = \"character\")\nsamlaDF=gather(data=intro_status_arbutd,variabler,tabellvariabel,-1)\nsum(is.na(samlaDF$tabellvariabel))\nsplitDF=separate(samlaDF,variabler,c(\"avslutta\",\"kjonn\",\"avslstat4\",\"aar\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,avslutta,c(\"variabel\",\"avslutta\"),(nchar(\"avslutta\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,kjonn,c(\"variabel\",\"kjonn\"),(nchar(\"kjonn\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,avslstat4,c(\"variabel\",\"avslstat4\"),(nchar(\"avslutning.status.4\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,aar,c(\"variabel\",\"aar\"),(nchar(\"aar\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),(nchar(\"enhet\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1] = paste0(\"0\",splitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1])\nsplitDF$avslutta = gsub(\"\\\\.\",\"_\",splitDF$avslutta)\nsplitDF$kjonn = gsub(\"\\\\.\",\"_\",splitDF$kjonn)\nsplitDF$avslstat4 = gsub(\"\\\\.\",\"_\",splitDF$avslstat4)\nsplitDF$aar = gsub(\"\\\\.\",\"_\",splitDF$aar)\nsplitDF$enhet = gsub(\"\\\\.\",\"_\",splitDF$enhet)\nsplitDF$tabell_navn = \"intro_status_arbutd\"\nlevels(as.factor(splitDF$avslstat4))\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/intro_status_arbutd-naringsregion-2011_2013.csv\",row.names=F)\n\n#BOSETTING_MAANED\n#27. okt\nlibrary(tidyr)\nbosetting_maaned <- read.csv(\"D:/R/imdikator-munch/data_crossed_input/bosetting_maaned-kommune-2012.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE,colClasses = \"character\")\nsamlaDF=gather(data=bosetting_maaned,variabler,tabellvariabel,-1)\nsum(is.na(samlaDF$tabellvariabel))\nsplitDF=separate(samlaDF,variabler,c(\"bosetting\",\"enhet\",\"maaned\"),\"_\")\nsplitDF=separate(splitDF,bosetting,c(\"variabel\",\"bosetting\"),(nchar(\"bosetting\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),(nchar(\"enhet\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,maaned,c(\"variabel\",\"maaned\"),(nchar(\"maned\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$kommune_nr[nchar(splitDF$kommune_nr)==3] = paste0(\"0\",splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3])\nsplitDF$tabell_navn = \"bosetting_maaned\"\nsplitDF$aar=2012\nlevels(as.factor(splitDF$maaned))\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/bosetting_maaned-kommune-2012-dummy.csv\",row.names=F)\n",
    "created" : 1449685059757.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3823221749",
    "id" : "CD885607",
    "lastKnownWriteTime" : 1447762615,
    "path" : "D:/R/imdikator-munch/flatfilkonvertering.R",
    "project_path" : "flatfilkonvertering.R",
    "properties" : {
    },
    "relative_order" : 3,
    "source_on_save" : false,
    "type" : "r_source"
}