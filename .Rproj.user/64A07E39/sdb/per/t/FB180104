{
    "contents" : "#SCRIPT FOR KONVERTERING TIL FLATFIL\n#Todo: \n#test av tidy-pakke på indikatordata\nlibrary(tidyr)\n\ntest <- read.csv(\"training_files/04-befolkning_alder-bydel-2014.csv\", header=FALSE, row.names=NULL, sep=\";\", na.strings = c(\"NA\",\".\",\":\"),stringsAsFactors = F)\n\n#tilnærming: multiple variables stored in one column\n#steg 1: samle verdier til en kolonnetittel\ndataHead = data.frame(test[1:4,])\ndataHead = data.frame(t(dataHead))\nnavn = colnames(dataHead)\ndataHead$kode <- do.call(paste, c(dataHead[navn], sep=\"-\"))\ndataHead = data.frame(t(dataHead))\n\n#STEG 2:setter inn en ny rad på et spesifisert sted og fjerner øverste rader\nover_kutt=4\ntestDF <- rbind(test[1:over_kutt,],dataHead[5,],test[-(1:over_kutt),])\ncolnames(testDF)=testDF[5,]\ntestDF=testDF[6:24,]\n\n#rydder slik at første kolonne inneholder riktige rownames og fjerner overflødige kolonner\n#bydel må være en variabel på linje med de andre, må legges inn over-.\ntestDF=testDF[,2:66]\ntestDF=subset(testDF,select=-`Bydel\\nnavn---`)\n\n#STEG 3: Split\n#samler alt opp først\ntemp_a=names(testDF[1])\nsamlaDF=gather(data=testDF,variabler,verdier,-`bydel_nr---`)\n\n#splitter så opp. må gjøres posisjonsvis.\nsplitDF=separate(samlaDF,variabler,c(\"innvkat\",\"alder_grupper\",\"kjonn\",\"enhet\"),\"-\")\n\n#splitter verdiene\nsplitDF=separate(splitDF,innvkat,c(\"variabel\",\"innvkat_3\"),\"\\\\.\")\nsplitDF=separate(splitDF,alder_grupper,c(\"variabel\",\"alder_grupper\"),\"\\\\.\")\nsplitDF=separate(splitDF,kjonn,c(\"variabel\",\"kjonn\"),\"\\\\.\")\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),\"\\\\.\")\n\nsplitDF[,1]\n#ferdig DF\nferdigDF=data.frame(splitDF[,1],splitDF$innvkat_3,splitDF$alder_grupper,splitDF$kjonn,splitDF$enhet,splitDF$verdier)\ncolnames(ferdigDF)=c(\"bydel_nr\",\"innvkat_3\",\"alder_grupper_5\",\"kjonn\",\"enhet\",\"tabellvariabel\")\n\n#test mot benglers konverterte flatfil\nlibrary(dplyr)\nkontroll_1 <- read.csv(\"data/befolkning_alder.csv\", header=T, row.names=NULL, sep=\",\", na.strings = \"NA\",stringsAsFactors = F)\nkontroll_2=subset(kontroll_1,subset=bydel_nr!=\"NULL\",select=c(-fylke_nr,-kommune_nr,-naringsregion_nr,-tabell_navn,-aar))\nkontroll_3=anti_join(kontroll_2,ferdigDF)\n\n#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE\n#BYDEL 2013\n#23. oktober 2015\nlibrary(tidyr)\n\n#feil: brukte na.strings, overskriver \".\" og \":\".\nbarnehagedeltakelse <- read.csv(\"data_crossed_input/30-barnehagedeltakelse-bydel-2013.csv\", header=T, row.names=NULL, sep=\";\", dec=\",\",,stringsAsFactors = F)\n#tilnærming: multiple variables stored in one column\n#steg 1: samle verdier til en kolonnetittel\n#gjort i excel\n#STEG 2:setter inn en ny rad på et spesifisert sted og fjerner øverste rader\n#gjort i excel\n#STEG 3: Split\n#samler alt opp først. \nsamlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with(\"barnikommune\")))\nsamlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with(\"barnikommune\"))\n#er det introdusert NA? erstatt i så fall med \".\"\n#fjernet - NA-erstatting er gjort av SSB pre-processing\n#lager to df, en med barnikommune og en med spraak\nsamlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))\nsamlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))\n#splitter så opp. må gjøres posisjonsvis. SPRAAK FØRST\n#bruk av _ som separator i variabelnavn gir trøbbel, \nsplitDF=separate(samlaDF_1,variabler,c(\"spraak\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraak,c(\"variabel\",\"spraak\"),7)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\n#erstatter nye tegn\nsplitDF$bydel_nr[splitDF$bydel_nr<99999]=paste0(\"0\",splitDF$bydel_nr)\nsplitDF$spraak = gsub(\"\\\\.\",\"_\",splitDF$spraak)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\n#legger til øvrige nødvendige verdier\nsplitDF$aar = 2013\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-bydel-2013.csv\",row.names=F)\n#BHGALDER\n#bruk av _ som separator i variabelnavn gir trøbbel, \nsplitDF=separate(samlaDF_2,variabler_2,c(\"barnikommune\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,barnikommune,c(\"variabel\",\"barnikommune\"),(nchar(\"barnikommume\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\n#erstatter nye tegn\nsplitDF$bydel_nr[splitDF$bydel_nr<99999]=paste0(\"0\",splitDF$bydel_nr)\nsplitDF$barnikommune = gsub(\"\\\\.\",\"_\",splitDF$barnikommune)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\n#legger til øvrige nødvendige verdier\nsplitDF$aar = 2013\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\n#skriver ut fil\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-bydel-2013.csv\",row.names=F)\n\n#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - BYDEL2014\nbarnehagedeltakelse <- read.csv(\"data_crossed_input/30-barnehagedeltakelse-bydel-2014.csv\", header=T, row.names=NULL, sep=\";\", dec=\",\", stringsAsFactors = F)\nsamlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with(\"barnikommune\")))\nsamlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with(\"barnikommune\"))\n#lager to df, en med barnikommune og en med spraak\nsamlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))\nsamlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))\n#SPRAAK\nsplitDF=separate(samlaDF_1,variabler,c(\"spraak\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraak,c(\"variabel\",\"spraak\"),7)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$bydel_nr[splitDF$bydel_nr<99999]=paste0(\"0\",splitDF$bydel_nr)\nsplitDF$spraak = gsub(\"\\\\.\",\"_\",splitDF$spraak)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = 2014\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-bydel-2014.csv\",row.names=F)\n#BHGALDER\nsplitDF=separate(samlaDF_2,variabler_2,c(\"barnikommune\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,barnikommune,c(\"variabel\",\"barnikommune\"),(nchar(\"barnikommume\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$bydel_nr[splitDF$bydel_nr<99999]=paste0(\"0\",splitDF$bydel_nr)\nsplitDF$barnikommune = gsub(\"\\\\.\",\"_\",splitDF$barnikommune)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = 2014\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-bydel-2014.csv\",row.names=F)\n\n#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - FYLKE2013\nbarnehagedeltakelse <- read.csv(\"data_crossed_input/30-barnehagedeltakelse-fylke-2013.csv\", header=T, row.names=NULL, sep=\";\", dec=\",\",stringsAsFactors = F)\nsamlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with(\"barnikommune\")))\nsamlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with(\"barnikommune\"))\nsum(is.na(samlaDF$tabellvariabel))\nsum(is.na(samlaDF$tabellvariabel_2))\nsamlaDF$tabellvariabel[is.na(samlaDF$tabellvariabel)]=\".\"\nsamlaDF$tabellvariabel_2[is.na(samlaDF$tabellvariabel_2)]=\".\"\nsum(is.na(samlaDF$tabellvariabel))\nsum(is.na(samlaDF$tabellvariabel_2))\n#lager to df, en med barnikommune og en med spraak\nsamlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))\nsamlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))\n#SPRAAK\nsplitDF=separate(samlaDF_1,variabler,c(\"spraak\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraak,c(\"variabel\",\"spraak\"),7)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0(\"0\",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])\nsplitDF$spraak = gsub(\"\\\\.\",\"_\",splitDF$spraak)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = 2013\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-fylke-2013.csv\",row.names=F)\n#BHGALDER\nsplitDF=separate(samlaDF_2,variabler_2,c(\"barnikommune\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,barnikommune,c(\"variabel\",\"barnikommune\"),(nchar(\"barnikommume\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0(\"0\",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])\nsplitDF$barnikommune = gsub(\"\\\\.\",\"_\",splitDF$barnikommune)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = 2013\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-fylke-2013.csv\",row.names=F)\n\n#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - FYLKE2014\nbarnehagedeltakelse <- read.csv(\"data_crossed_input/30-barnehagedeltakelse-fylke-2014.csv\", header=T, row.names=NULL, sep=\";\", dec=\",\",stringsAsFactors = F)\nsamlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with(\"barnikommune\")))\nsamlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with(\"barnikommune\"))\nsum(is.na(samlaDF$tabellvariabel))\nsum(is.na(samlaDF$tabellvariabel_2))\nsamlaDF$tabellvariabel[is.na(samlaDF$tabellvariabel)]=\".\"\nsamlaDF$tabellvariabel_2[is.na(samlaDF$tabellvariabel_2)]=\".\"\nsum(is.na(samlaDF$tabellvariabel))\nsum(is.na(samlaDF$tabellvariabel_2))\n#lager to df, en med barnikommune og en med spraak\nsamlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))\nsamlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))\n#SPRAAK\nsplitDF=separate(samlaDF_1,variabler,c(\"spraak\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraak,c(\"variabel\",\"spraak\"),7)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0(\"0\",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])\nsplitDF$spraak = gsub(\"\\\\.\",\"_\",splitDF$spraak)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = 2014\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-fylke-2014.csv\",row.names=F)\n#BHGALDER\nsplitDF=separate(samlaDF_2,variabler_2,c(\"barnikommune\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,barnikommune,c(\"variabel\",\"barnikommune\"),(nchar(\"barnikommume\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$fylke_nr[nchar(splitDF$fylke_nr)==1] = paste0(\"0\",splitDF$fylke_nr[nchar(splitDF$fylke_nr)==1])\nsplitDF$barnikommune = gsub(\"\\\\.\",\"_\",splitDF$barnikommune)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = 2014\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-fylke-2014.csv\",row.names=F)\n\n#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - KOMMUNE2013\nbarnehagedeltakelse <- read.csv(\"data_crossed_input/30-barnehagedeltakelse-kommune-2013.csv\", header=T, row.names=NULL, sep=\";\", dec=\",\", stringsAsFactors = F)\nsamlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with(\"barnikommune\")))\nsamlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with(\"barnikommune\"))\nsum(is.na(samlaDF$tabellvariabel))\nsum(is.na(samlaDF$tabellvariabel_2))\nsamlaDF$tabellvariabel[is.na(samlaDF$tabellvariabel)]=\".\"\nsamlaDF$tabellvariabel_2[is.na(samlaDF$tabellvariabel_2)]=\".\"\nsum(is.na(samlaDF$tabellvariabel))\nsum(is.na(samlaDF$tabellvariabel_2))\n#lager to df, en med barnikommune og en med spraak\nsamlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))\nsamlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))\n#SPRAAK\nsplitDF=separate(samlaDF_1,variabler,c(\"spraak\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraak,c(\"variabel\",\"spraak\"),7)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$kommune_nr[nchar(splitDF$kommune_nr)==3] = paste0(\"0\",splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3])\nsplitDF$spraak = gsub(\"\\\\.\",\"_\",splitDF$spraak)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = 2013\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-kommune-2013.csv\",row.names=F)\n#BHGALDER\nsplitDF=separate(samlaDF_2,variabler_2,c(\"barnikommune\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,barnikommune,c(\"variabel\",\"barnikommune\"),(nchar(\"barnikommume\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$kommune_nr[nchar(splitDF$kommune_nr)==3] = paste0(\"0\",splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3])\nsplitDF$barnikommune = gsub(\"\\\\.\",\"_\",splitDF$barnikommune)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = 2013\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-kommune-2013.csv\",row.names=F)\n\n#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - KOMMUNE2014\nbarnehagedeltakelse <- read.csv(\"data_crossed_input/30-barnehagedeltakelse-kommune-2014.csv\", header=T, row.names=NULL, sep=\";\", dec=\",\", stringsAsFactors = F)\nsamlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with(\"barnikommune\")))\nsamlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with(\"barnikommune\"))\nsum(is.na(samlaDF$tabellvariabel))\nsum(is.na(samlaDF$tabellvariabel_2))\nsamlaDF$tabellvariabel[is.na(samlaDF$tabellvariabel)]=\".\"\nsamlaDF$tabellvariabel_2[is.na(samlaDF$tabellvariabel_2)]=\".\"\nsum(is.na(samlaDF$tabellvariabel))\nsum(is.na(samlaDF$tabellvariabel_2))\n#lager to df, en med barnikommune og en med spraak\nsamlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))\nsamlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))\n#SPRAAK\nsplitDF=separate(samlaDF_1,variabler,c(\"spraak\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraak,c(\"variabel\",\"spraak\"),7)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$kommune_nr[nchar(splitDF$kommune_nr)==3] = paste0(\"0\",splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3])\nsplitDF$spraak = gsub(\"\\\\.\",\"_\",splitDF$spraak)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = 2014\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-kommune-2014.csv\",row.names=F)\n#BHGALDER\nsplitDF=separate(samlaDF_2,variabler_2,c(\"barnikommune\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,barnikommune,c(\"variabel\",\"barnikommune\"),(nchar(\"barnikommume\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$kommune_nr[nchar(splitDF$kommune_nr)==3] = paste0(\"0\",splitDF$kommune_nr[nchar(splitDF$kommune_nr)==3])\nsplitDF$barnikommune = gsub(\"\\\\.\",\"_\",splitDF$barnikommune)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = 2014\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-kommune-2014.csv\",row.names=F)\n\n#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - NÆRINGSREGION2013\nbarnehagedeltakelse <- read.csv(\"data_crossed_input/30-barnehagedeltakelse-naringsregion-2013.csv\", header=T, row.names=NULL, sep=\";\", dec=\",\", stringsAsFactors = F)\nsamlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with(\"barnikommune\")))\nsamlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with(\"barnikommune\"))\nsum(is.na(samlaDF$tabellvariabel))\nsum(is.na(samlaDF$tabellvariabel_2))\nsamlaDF$tabellvariabel[is.na(samlaDF$tabellvariabel)]=\".\"\nsamlaDF$tabellvariabel_2[is.na(samlaDF$tabellvariabel_2)]=\".\"\nsum(is.na(samlaDF$tabellvariabel))\nsum(is.na(samlaDF$tabellvariabel_2))\n#lager to df, en med barnikommune og en med spraak\nsamlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))\nsamlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))\n#SPRAAK\nsplitDF=separate(samlaDF_1,variabler,c(\"spraak\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraak,c(\"variabel\",\"spraak\"),7)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1] = paste0(\"0\",splitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1])\nsplitDF$spraak = gsub(\"\\\\.\",\"_\",splitDF$spraak)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = 2013\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-naringsregion-2013.csv\",row.names=F)\n#BHGALDER\nsplitDF=separate(samlaDF_2,variabler_2,c(\"barnikommune\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,barnikommune,c(\"variabel\",\"barnikommune\"),(nchar(\"barnikommume\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1] = paste0(\"0\",splitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1])\nsplitDF$barnikommune = gsub(\"\\\\.\",\"_\",splitDF$barnikommune)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = 2013\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-naringsregion-2013.csv\",row.names=F)\n\n#KONVERTERING TIL FLATFIL - BARNEHAGEDELTAKELSE - NÆRINGSREGION2014\nbarnehagedeltakelse <- read.csv(\"data_crossed_input/30-barnehagedeltakelse-naringsregion-2014.csv\", header=T, row.names=NULL, sep=\";\", dec=\",\", stringsAsFactors = F)\nsamlaDF=gather(data=barnehagedeltakelse,variabler,tabellvariabel,c(-1,-starts_with(\"barnikommune\")))\nsamlaDF=gather(data=samlaDF,variabler_2,tabellvariabel_2,starts_with(\"barnikommune\"))\nsum(is.na(samlaDF$tabellvariabel))\nsum(is.na(samlaDF$tabellvariabel_2))\nsamlaDF$tabellvariabel[is.na(samlaDF$tabellvariabel)]=\".\"\nsamlaDF$tabellvariabel_2[is.na(samlaDF$tabellvariabel_2)]=\".\"\nsum(is.na(samlaDF$tabellvariabel))\nsum(is.na(samlaDF$tabellvariabel_2))\n#lager to df, en med barnikommune og en med spraak\nsamlaDF_1 = subset(samlaDF,select = -c(variabler_2,tabellvariabel_2))\nsamlaDF_2 = subset(samlaDF,select = -c(variabler,tabellvariabel))\n#SPRAAK\nsplitDF=separate(samlaDF_1,variabler,c(\"spraak\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,spraak,c(\"variabel\",\"spraak\"),7)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1] = paste0(\"0\",splitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1])\nsplitDF$spraak = gsub(\"\\\\.\",\"_\",splitDF$spraak)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = 2014\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_1-naringsregion-2014.csv\",row.names=F)\n#BHGALDER\nsplitDF=separate(samlaDF_2,variabler_2,c(\"barnikommune\",\"bhgalder\",\"enhet\"),\"_\")\nsplitDF=separate(splitDF,barnikommune,c(\"variabel\",\"barnikommune\"),(nchar(\"barnikommume\")+1))\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,bhgalder,c(\"variabel\",\"bhgalder\"),9)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF=separate(splitDF,enhet,c(\"variabel\",\"enhet\"),6)\nsplitDF=subset(splitDF,select=-variabel)\nsplitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1] = paste0(\"0\",splitDF$naringsregion_nr[nchar(splitDF$naringsregion_nr)==1])\nsplitDF$barnikommune = gsub(\"\\\\.\",\"_\",splitDF$barnikommune)\nsplitDF$bhgalder = gsub(\"\\\\.\",\"_\",splitDF$bhgalder)\nsplitDF$aar = 2014\nsplitDF$tabell_navn = \"barnehagedeltakelse\"\nwrite.csv(splitDF,\"D:/R/imdikator-munch/data_flat_output/30-barnehagedeltakelse_2-naringsregion-2014.csv\",row.names=F)",
    "created" : 1445594290395.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "1148999168",
    "id" : "FB180104",
    "lastKnownWriteTime" : 1445791929,
    "path" : "D:/R/imdikator-munch/flatfilkonvertering.R",
    "project_path" : "flatfilkonvertering.R",
    "properties" : {
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}