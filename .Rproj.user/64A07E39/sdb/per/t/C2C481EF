{
    "contents" : "#SCRIPT FOR DIAGNOSE\n\n#RYDDEAMBISJON\n#dette scriptet må dokumentere hva som er kommet inn, og hva som er gjort med disse filene.\n#først: hvilke endringer og rettelser som er gjort på Benglers flatfilleveranse\n#så: hva som er gjort med SSBs leveranse i 2015\n\n#BEFOLKNING-ALDER\nbefolkning_alder <- read.csv2(\"D:/R/imdikator-munch/data_flat_input/befolkning_alder_B.csv\", stringsAsFactors=FALSE,colClasses = \"character\")\n#etter visuell inspeksjon\n#1: en kolonne for mye\n#2: alder_grupper-variabler har - som skilletegn, ikke _\n#3: X_id, ikke X_nr\n#4: bydel_nr mangler 0301 først.\n#5: enhet-variabel er person, ikke personer\n#6: alder_grupper-dimensjon mangler alle-variabel\n#7: må ha sep=, dec=.\n#8: fylke=00 og alle andre fylker kan ikke legges i ulike filer. disse må splices.\n#løses i variabel_adding.R\n\n#BARNEHAGEDELTAKELSE\ntest <- read.csv(\"D:/R/imdikator-munch/data_flat_output/barnehagedeltakelse_spraak-bydel-2013.csv\", stringsAsFactors=FALSE,colClasses = \"character\")\nwrite.csv(test,\"data_flat_output/test.csv\",row.names = F)\n\n#GRUNNSKOLEPOENG\n#26.10.2015\ngrunnskolepoeng <- read.csv(\"D:/R/imdikator-munch/data_flat_input/grunnskolepoeng.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE)\ndf = subset(grunnskolepoeng,kommune_nr!=\"NULL\",select=-c(bydel_nr,fylke_nr,naringsregion_nr))\n\ndf_test = subset(grunnskolepoeng,bydel_nr!=\"NULL\")\n\n#diagnose:\n#kjønnsfordeling for kommune er ikke uniform (har 0 og 1 for alle, og alle for andre kategorier)\n#vreg3 og invalder er kun tilgjengelig for andre enheter enn kommune, og tegnes ikke ut i grensesnittet\n#skaper det trøbbel at de inngår?\n#løsning 1: økse alt anna enn kjønn, fylle inn manglende kombinasjoner av kjønn med manglende data\n#løsning 2: fylle inn manglende komboer av kjønn, ikke røre noe annet.\n\n#NORSK - PROVER\nnorsk_prover <- read.csv(\"D:/R/imdikator-munch/data_flat_input/norsk_prover.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE)\n\n#provetype mangler alle\n#spraakniva.alle mangler prosenter\n#løses i excel, lettere å legge sammen der\n\nnorsk_prover <- read.csv(\"D:/R/imdikator-munch/data_crossed_input/norsk_prover-fylke-halvar2014.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\n#krysstabell, ikke flat.\n\n#intro avslutning direkte\n#26. oktober\n#utfordringer: dele i to filer, en 8-delt og en 3-delt.\n#kode om prosenter fra \":\" til \".\".\n\n#INTRO_STATUS_ARBUTD\n#27.okt\nintro_status_arbutd <- read.csv(\"D:/R/imdikator-munch/data_crossed_input/intro_status_arbutd-fylke-2011_2013.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE,colClasses = \"character\")\n#17. nov\nintro_status_arbutd <- read.csv(\"D:/R/imdikator-munch/data_crossed_input/intro_status_arbutd-naringsregion-2011_2013.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE,colClasses = \"character\")\n\n#Befolkning_hovedgruppe\n#6. desember 2015\nbefolkning_hovedgruppe <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_hovedgruppe_B.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\n#1. Bydel-ID har feil lengde\n#2. Bydel_nr\n#3. feil sep\nbefolkning_hovedgruppe$bydel_id[nchar(befolkning_hovedgruppe$bydel_id)==1] = paste0(\"0\",befolkning_hovedgruppe$bydel_id[nchar(befolkning_hovedgruppe$bydel_id)==1])\nbefolkning_hovedgruppe$bydel_id[nchar(befolkning_hovedgruppe$bydel_id)==2] = paste0(\"0301\",befolkning_hovedgruppe$bydel_id[nchar(befolkning_hovedgruppe$bydel_id)==2])\nnames(befolkning_hovedgruppe)[3] = \"bydel_nr\"\nwrite.csv(befolkning_hovedgruppe,\"D:/R/imdikator-munch/data_flat_output/befolkning_hovedgruppe-bydel-2015.csv\",row.names=F)\nbefolkning_hovedgruppe <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_hovedgruppe_K.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\n#1. kommune-ID har feil lengde\n#2. Bydel_nr\n#3. feil sep\nbefolkning_hovedgruppe = subset(befolkning_hovedgruppe,select=-8)\nbefolkning_hovedgruppe$kommune_id[nchar(befolkning_hovedgruppe$kommune_id)==3] = paste0(\"0\",befolkning_hovedgruppe$kommune_id[nchar(befolkning_hovedgruppe$kommune_id)==3])\nnames(befolkning_hovedgruppe)[3] = \"kommune_nr\"\nwrite.csv(befolkning_hovedgruppe,\"D:/R/imdikator-munch/data_flat_output/befolkning_hovedgruppe-kommune-2015.csv\",row.names=F)\nbefolkning_hovedgruppe <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_hovedgruppe_N.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\n#0. en kolonne for mye\n#1. kommune-ID har feil lengde\n#2. Bydel_nr\n#3. feil sep\nbefolkning_hovedgruppe = subset(befolkning_hovedgruppe,select=-8)\nbefolkning_hovedgruppe$naringsregion_id[nchar(befolkning_hovedgruppe$naringsregion_id)==1] = paste0(\"0\",befolkning_hovedgruppe$naringsregion_id[nchar(befolkning_hovedgruppe$naringsregion_id)==1])\nnames(befolkning_hovedgruppe)[3] = \"naringsregion_nr\"\nwrite.csv(befolkning_hovedgruppe,\"D:/R/imdikator-munch/data_flat_output/befolkning_hovedgruppe-naringsregion-2015.csv\",row.names=F)\nbefolkning_hovedgruppe <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_hovedgruppe_F.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\n#0. en kolonne for mye\n#1. kommune-ID har feil lengde\n#2. Bydel_nr\n#3. feil sep\n#4. nasjonstall lagret i egen fil\nbefolkning_hovedgruppe = subset(befolkning_hovedgruppe,select=-8)\nbefolkning_hovedgruppe$fylke_id[nchar(befolkning_hovedgruppe$fylke_id)==1] = paste0(\"0\",befolkning_hovedgruppe$fylke_id[nchar(befolkning_hovedgruppe$fylke_id)==1])\nnames(befolkning_hovedgruppe)[3] = \"fylke_nr\"\nbefolkning_hovedgruppe_norge <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_hovedgruppe_L.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\nbefolkning_hovedgruppe_norge = subset(befolkning_hovedgruppe_norge,select=-8)\nbefolkning_hovedgruppe_norge$fylke_id[nchar(befolkning_hovedgruppe_norge$fylke_id)==1] = paste0(\"0\",befolkning_hovedgruppe_norge$fylke_id[nchar(befolkning_hovedgruppe_norge$fylke_id)==1])\nnames(befolkning_hovedgruppe_norge)[3] = \"fylke_nr\"\nbefolkning_hovedgruppe = rbind(befolkning_hovedgruppe,befolkning_hovedgruppe_norge)\nwrite.csv(befolkning_hovedgruppe,\"D:/R/imdikator-munch/data_flat_output/befolkning_hovedgruppe-fylke-2015.csv\",row.names=F)\n\n#BEfolkning_innvandringsgrunn\n#6. desember 2015\nbefolkning_innvandringsgrunn <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_innvandringsgrunn_B_2014.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\n#0. en kolonne for mye\n#1. Bydel-ID har feil lengde\n#2. Bydel_nr\n#3. feil sep\n#4. innvgrunn_6 har tomme verdier\nbefolkning_innvandringsgrunn = subset(befolkning_innvandringsgrunn,select=-8)\nbefolkning_innvandringsgrunn$bydel_id[nchar(befolkning_innvandringsgrunn$bydel_id)==1] = paste0(\"0\",befolkning_innvandringsgrunn$bydel_id[nchar(befolkning_innvandringsgrunn$bydel_id)==1])\nbefolkning_innvandringsgrunn$bydel_id[nchar(befolkning_innvandringsgrunn$bydel_id)==2] = paste0(\"0301\",befolkning_innvandringsgrunn$bydel_id[nchar(befolkning_innvandringsgrunn$bydel_id)==2])\nnames(befolkning_innvandringsgrunn)[3] = \"bydel_nr\"\nlevels(as.factor(befolkning_innvandringsgrunn$innvgrunn_6))\nbefolkning_innvandringsgrunn = subset(befolkning_innvandringsgrunn,innvgrunn_6!=\" \")\nwrite.csv(befolkning_innvandringsgrunn,\"D:/R/imdikator-munch/data_flat_output/befolkning_innvandringsgrunn-bydel-2014.csv\",row.names=F)\n#2015\nbefolkning_innvandringsgrunn <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_innvandringsgrunn_B_2015.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\n#0. en kolonne for mye\n#1. Bydel-ID har feil lengde\n#2. Bydel_nr\n#3. feil sep\n#4. innvgrunn_6 har tomme verdier\nbefolkning_innvandringsgrunn = subset(befolkning_innvandringsgrunn,select=-8)\nbefolkning_innvandringsgrunn$bydel_id[nchar(befolkning_innvandringsgrunn$bydel_id)==1] = paste0(\"0\",befolkning_innvandringsgrunn$bydel_id[nchar(befolkning_innvandringsgrunn$bydel_id)==1])\nbefolkning_innvandringsgrunn$bydel_id[nchar(befolkning_innvandringsgrunn$bydel_id)==2] = paste0(\"0301\",befolkning_innvandringsgrunn$bydel_id[nchar(befolkning_innvandringsgrunn$bydel_id)==2])\nnames(befolkning_innvandringsgrunn)[3] = \"bydel_nr\"\nlevels(as.factor(befolkning_innvandringsgrunn$innvgrunn_6))\nbefolkning_innvandringsgrunn = subset(befolkning_innvandringsgrunn,innvgrunn_6!=\" \")\nwrite.csv(befolkning_innvandringsgrunn,\"D:/R/imdikator-munch/data_flat_output/befolkning_innvandringsgrunn-bydel-2015.csv\",row.names=F)\n\n#2014-kommune\nbefolkning_innvandringsgrunn <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_innvandringsgrunn_K_2014.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\n#0. en kolonne for mye\n#1. Bydel-ID har feil lengde\n#2. Bydel_nr\n#3. feil sep\n#4. innvgrunn_6 har tomme verdier\nbefolkning_innvandringsgrunn = subset(befolkning_innvandringsgrunn,select=-8)\nbefolkning_innvandringsgrunn$kommune_id[nchar(befolkning_innvandringsgrunn$kommune_id)==3] = paste0(\"0\",befolkning_innvandringsgrunn$kommune_id[nchar(befolkning_innvandringsgrunn$kommune_id)==3])\nnames(befolkning_innvandringsgrunn)[3] = \"kommune_nr\"\nlevels(as.factor(befolkning_innvandringsgrunn$innvgrunn_6))\nbefolkning_innvandringsgrunn = subset(befolkning_innvandringsgrunn,innvgrunn_6!=\" \")\nwrite.csv(befolkning_innvandringsgrunn,\"D:/R/imdikator-munch/data_flat_output/befolkning_innvandringsgrunn-kommune-2014.csv\",row.names=F)\n\n#2015-kommune\nbefolkning_innvandringsgrunn <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_innvandringsgrunn_K_2015.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\n#0. en kolonne for mye\n#1. Bydel-ID har feil lengde\n#2. Bydel_nr\n#3. feil sep\n#4. innvgrunn_6 har tomme verdier\nbefolkning_innvandringsgrunn = subset(befolkning_innvandringsgrunn,select=-8)\nbefolkning_innvandringsgrunn$kommune_id[nchar(befolkning_innvandringsgrunn$kommune_id)==3] = paste0(\"0\",befolkning_innvandringsgrunn$kommune_id[nchar(befolkning_innvandringsgrunn$kommune_id)==3])\nnames(befolkning_innvandringsgrunn)[3] = \"kommune_nr\"\nlevels(as.factor(befolkning_innvandringsgrunn$innvgrunn_6))\nbefolkning_innvandringsgrunn = subset(befolkning_innvandringsgrunn,innvgrunn_6!=\" \")\nwrite.csv(befolkning_innvandringsgrunn,\"D:/R/imdikator-munch/data_flat_output/befolkning_innvandringsgrunn-kommune-2015.csv\",row.names=F)\n\n#2014-næringsregion\nbefolkning_innvandringsgrunn <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_innvandringsgrunn_N_2014.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\n#0. en kolonne for mye\n#1. Bydel-ID har feil lengde\n#2. Bydel_nr\n#3. feil sep\n#4. innvgrunn_6 har tomme verdier\nbefolkning_innvandringsgrunn = subset(befolkning_innvandringsgrunn,select=-8)\nbefolkning_innvandringsgrunn$naringsregion_id[nchar(befolkning_innvandringsgrunn$naringsregion_id)==1] = paste0(\"0\",befolkning_innvandringsgrunn$naringsregion_id[nchar(befolkning_innvandringsgrunn$naringsregion_id)==1])\nnames(befolkning_innvandringsgrunn)[3] = \"naringsregion_nr\"\nlevels(as.factor(befolkning_innvandringsgrunn$innvgrunn_6))\nbefolkning_innvandringsgrunn = subset(befolkning_innvandringsgrunn,innvgrunn_6!=\" \")\nwrite.csv(befolkning_innvandringsgrunn,\"D:/R/imdikator-munch/data_flat_output/befolkning_innvandringsgrunn-naringsregion-2014.csv\",row.names=F)\n\n#2015-næringsregion\nbefolkning_innvandringsgrunn <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_innvandringsgrunn_N_2015.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\n#0. en kolonne for mye\n#1. Bydel-ID har feil lengde\n#2. Bydel_nr\n#3. feil sep\n#4. innvgrunn_6 har tomme verdier\nbefolkning_innvandringsgrunn = subset(befolkning_innvandringsgrunn,select=-8)\nbefolkning_innvandringsgrunn$naringsregion_id[nchar(befolkning_innvandringsgrunn$naringsregion_id)==1] = paste0(\"0\",befolkning_innvandringsgrunn$naringsregion_id[nchar(befolkning_innvandringsgrunn$naringsregion_id)==1])\nnames(befolkning_innvandringsgrunn)[3] = \"naringsregion_nr\"\nlevels(as.factor(befolkning_innvandringsgrunn$innvgrunn_6))\nbefolkning_innvandringsgrunn = subset(befolkning_innvandringsgrunn,innvgrunn_6!=\" \")\nwrite.csv(befolkning_innvandringsgrunn,\"D:/R/imdikator-munch/data_flat_output/befolkning_innvandringsgrunn-naringsregion-2015.csv\",row.names=F)\n\n#2014-fylke\nbefolkning_innvandringsgrunn <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_innvandringsgrunn_F_2014.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\n#0. en kolonne for mye\n#1. Bydel-ID har feil lengde\n#2. Bydel_nr\n#3. feil sep\n#4. innvgrunn_6 har tomme verdier\n#5. mangler nasjonale tall\nbefolkning_innvandringsgrunn = subset(befolkning_innvandringsgrunn,select=-8)\nbefolkning_innvandringsgrunn$fylke_id[nchar(befolkning_innvandringsgrunn$fylke_id)==1] = paste0(\"0\",befolkning_innvandringsgrunn$fylke_id[nchar(befolkning_innvandringsgrunn$fylke_id)==1])\nnames(befolkning_innvandringsgrunn)[3] = \"fylke_nr\"\nlevels(as.factor(befolkning_innvandringsgrunn$innvgrunn_6))\nbefolkning_innvandringsgrunn = subset(befolkning_innvandringsgrunn,innvgrunn_6!=\" \")\nbefolkning_innvandringsgrunn_norge <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_innvandringsgrunn_L_2014.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\nbefolkning_innvandringsgrunn_norge = subset(befolkning_innvandringsgrunn_norge,select=-8)\nbefolkning_innvandringsgrunn_norge$fylke_id[nchar(befolkning_innvandringsgrunn_norge$fylke_id)==1] = paste0(\"0\",befolkning_innvandringsgrunn_norge$fylke_id[nchar(befolkning_innvandringsgrunn_norge$fylke_id)==1])\nnames(befolkning_innvandringsgrunn_norge)[3] = \"fylke_nr\"\nlevels(as.factor(befolkning_innvandringsgrunn_norge$innvgrunn_6))\nbefolkning_innvandringsgrunn_norge = subset(befolkning_innvandringsgrunn_norge,innvgrunn_6!=\" \")\nbefolkning_innvandringsgrunn = rbind(befolkning_innvandringsgrunn,befolkning_innvandringsgrunn_norge)\nwrite.csv(befolkning_innvandringsgrunn,\"D:/R/imdikator-munch/data_flat_output/befolkning_innvandringsgrunn-fylke-2014.csv\",row.names=F)\n\n#2015-fylke\nbefolkning_innvandringsgrunn <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_innvandringsgrunn_F_2015.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\n#0. en kolonne for mye\n#1. Bydel-ID har feil lengde\n#2. Bydel_nr\n#3. feil sep\n#4. innvgrunn_6 har tomme verdier\n#5. mangler nasjonale tall\nbefolkning_innvandringsgrunn = subset(befolkning_innvandringsgrunn,select=-8)\nbefolkning_innvandringsgrunn$fylke_id[nchar(befolkning_innvandringsgrunn$fylke_id)==1] = paste0(\"0\",befolkning_innvandringsgrunn$fylke_id[nchar(befolkning_innvandringsgrunn$fylke_id)==1])\nnames(befolkning_innvandringsgrunn)[3] = \"fylke_nr\"\nlevels(as.factor(befolkning_innvandringsgrunn$innvgrunn_6))\nbefolkning_innvandringsgrunn = subset(befolkning_innvandringsgrunn,innvgrunn_6!=\" \")\nbefolkning_innvandringsgrunn_norge <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_innvandringsgrunn_L_2015.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\nbefolkning_innvandringsgrunn_norge = subset(befolkning_innvandringsgrunn_norge,select=-8)\nbefolkning_innvandringsgrunn_norge$fylke_id[nchar(befolkning_innvandringsgrunn_norge$fylke_id)==1] = paste0(\"0\",befolkning_innvandringsgrunn_norge$fylke_id[nchar(befolkning_innvandringsgrunn_norge$fylke_id)==1])\nnames(befolkning_innvandringsgrunn_norge)[3] = \"fylke_nr\"\nlevels(as.factor(befolkning_innvandringsgrunn_norge$innvgrunn_6))\nbefolkning_innvandringsgrunn_norge = subset(befolkning_innvandringsgrunn_norge,innvgrunn_6!=\" \")\nbefolkning_innvandringsgrunn = rbind(befolkning_innvandringsgrunn,befolkning_innvandringsgrunn_norge)\nwrite.csv(befolkning_innvandringsgrunn,\"D:/R/imdikator-munch/data_flat_output/befolkning_innvandringsgrunn-fylke-2015.csv\",row.names=F)\n\n#BEFOLKNING_OPPRINNELSESLAND\nbefolkning_opprinnelsesland <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_opprinnelsesland_B.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\n#1. Bydel-ID har feil lengde\n#2. Bydel_nr\n#3. feil sep\nlevels(as.factor(befolkning_opprinnelsesland$kjonn))\nbefolkning_opprinnelsesland = subset(befolkning_opprinnelsesland,select=c(-8,-kjonn))\nbefolkning_opprinnelsesland$bydel_id[nchar(befolkning_opprinnelsesland$bydel_id)==1] = paste0(\"0\",befolkning_opprinnelsesland$bydel_id[nchar(befolkning_opprinnelsesland$bydel_id)==1])\nbefolkning_opprinnelsesland$bydel_id[nchar(befolkning_opprinnelsesland$bydel_id)==2] = paste0(\"0301\",befolkning_opprinnelsesland$bydel_id[nchar(befolkning_opprinnelsesland$bydel_id)==2])\nnames(befolkning_opprinnelsesland)[3] = \"bydel_nr\"\nwrite.csv(befolkning_opprinnelsesland,\"D:/R/imdikator-munch/data_flat_output/befolkning_opprinnelsesland-bydel-2015.csv\",row.names=F)\n\n#kommune\nbefolkning_opprinnelsesland <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_opprinnelsesland_K.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\n#1. kommune-ID har feil lengde\n#2. kommune_nr\n#3. feil sep\nlevels(as.factor(befolkning_opprinnelsesland$kjonn))\nbefolkning_opprinnelsesland = subset(befolkning_opprinnelsesland,select=c(-8,-kjonn))\nbefolkning_opprinnelsesland$kommune_id[nchar(befolkning_opprinnelsesland$kommune_id)==3] = paste0(\"0\",befolkning_opprinnelsesland$kommune_id[nchar(befolkning_opprinnelsesland$kommune_id)==3])\nnames(befolkning_opprinnelsesland)[3] = \"kommune_nr\"\nwrite.csv(befolkning_opprinnelsesland,\"D:/R/imdikator-munch/data_flat_output/befolkning_opprinnelsesland-kommune-2015.csv\",row.names=F)\n\n#naringsregion\nbefolkning_opprinnelsesland <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_opprinnelsesland_N.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\n#1. naringsregion-ID har feil lengde\n#2. naringsregion_nr\n#3. feil sep\nlevels(as.factor(befolkning_opprinnelsesland$kjonn))\nbefolkning_opprinnelsesland = subset(befolkning_opprinnelsesland,select=c(-8,-kjonn))\nbefolkning_opprinnelsesland$naringsregion_id[nchar(befolkning_opprinnelsesland$naringsregion_id)==1] = paste0(\"0\",befolkning_opprinnelsesland$naringsregion_id[nchar(befolkning_opprinnelsesland$naringsregion_id)==1])\nnames(befolkning_opprinnelsesland)[3] = \"naringsregion_nr\"\nwrite.csv(befolkning_opprinnelsesland,\"D:/R/imdikator-munch/data_flat_output/befolkning_opprinnelsesland-naringsregion-2015.csv\",row.names=F)\n\n#fylke + land\nbefolkning_opprinnelsesland <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_opprinnelsesland_F.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\n#1. fylke-ID har feil lengde\n#2. fylke_nr\n#3. feil sep\nlevels(as.factor(befolkning_opprinnelsesland$kjonn))\nbefolkning_opprinnelsesland = subset(befolkning_opprinnelsesland,select=c(-8,-kjonn))\nbefolkning_opprinnelsesland$fylke_id[nchar(befolkning_opprinnelsesland$fylke_id)==1] = paste0(\"0\",befolkning_opprinnelsesland$fylke_id[nchar(befolkning_opprinnelsesland$fylke_id)==1])\nnames(befolkning_opprinnelsesland)[3] = \"fylke_nr\"\nbefolkning_opprinnelsesland_norge <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_opprinnelsesland_L.csv\", row.names=NULL, sep=\";\", dec=\",\", na.strings=\"NA\", stringsAsFactors=FALSE)\nlevels(as.factor(befolkning_opprinnelsesland_norge$kjonn))\nbefolkning_opprinnelsesland_norge = subset(befolkning_opprinnelsesland_norge,select=c(-8,-kjonn))\nbefolkning_opprinnelsesland_norge$fylke_id[nchar(befolkning_opprinnelsesland_norge$fylke_id)==1] = paste0(\"0\",befolkning_opprinnelsesland_norge$fylke_id[nchar(befolkning_opprinnelsesland_norge$fylke_id)==1])\nnames(befolkning_opprinnelsesland_norge)[3] = \"fylke_nr\"\nbefolkning_opprinnelsesland = rbind(befolkning_opprinnelsesland,befolkning_opprinnelsesland_norge)\nwrite.csv(befolkning_opprinnelsesland,\"D:/R/imdikator-munch/data_flat_output/befolkning_opprinnelsesland-fylke-2015.csv\",row.names=F)\n\n#BEFOLKNING_Verdensregion\n#6. desember 2015\n#1. feil tabellnavn\n#2. mangler alle-variabel på vreg_variabel, feil vreg-variabel\n#3. id, ikke nr, feil sep\n#4. land er egen fil, ikke i fylket.\n# en kolonne for mye\n\n#BEFOLKNING_VERDENSREGION_3 - Bydel\nbefolkning_verdensregion_2 <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_verdensregion_2B.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\")\nbefolkning_verdensregion_2 = subset(befolkning_verdensregion_2,select=-8)\nbefolkning_verdensregion_2$bydel_id[nchar(befolkning_verdensregion_2$bydel_id)==1] = paste0(\"0\",befolkning_verdensregion_2$bydel_id[nchar(befolkning_verdensregion_2$bydel_id)==1])\nbefolkning_verdensregion_2$bydel_id[nchar(befolkning_verdensregion_2$bydel_id)==2] = paste0(\"0301\",befolkning_verdensregion_2$bydel_id[nchar(befolkning_verdensregion_2$bydel_id)==2])\nnames(befolkning_verdensregion_2)[3] = \"bydel_nr\"\nlibrary(tidyr)\ndf=spread(befolkning_verdensregion_2,vreg_2,tabellvariabel)\ndf$alle=extract_numeric(df[,6])+extract_numeric(df[,7])\n#er det innført NA?\nsum(is.na(df$alle))\n#koder denne om til \".\" manglende data\n#samler vreg-variabler til vreg_3\ndf_2=gather(df,vreg_3,tabellvariabel,6:8,na.rm=F)\n#er ny df utvidet med riktig nrow?\nnrow(df_2)==nrow(befolkning_verdensregion_2)+nrow(df)-sum(is.na(df$alle))\nnrow(df_2)==nrow(befolkning_verdensregion_2)+sum(befolkning_verdensregion_2$vreg_2==\"1\")\nsum(df_2$vreg_3==\"alle\")==sum(befolkning_verdensregion_2$vreg_2==1)\n#ingen avvik.\n#anna informasjon som må oppdateres\ndf_2$tabell_navn=\"befolkning_verdensregion_3\"\nwrite.csv(df_2,\"D:/R/imdikator-munch/data_flat_output/befolkning_verdensregion_3-bydel-2015.csv\",row.names=F)\n\n#BEFOLKNING_VERDENSREGION_3 - kommune\nbefolkning_verdensregion_2 <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_verdensregion_2K.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\")\nbefolkning_verdensregion_2 = subset(befolkning_verdensregion_2,select=-8)\nbefolkning_verdensregion_2$kommune_id[nchar(befolkning_verdensregion_2$kommune_id)==3] = paste0(\"0\",befolkning_verdensregion_2$kommune_id[nchar(befolkning_verdensregion_2$kommune_id)==3])\nnames(befolkning_verdensregion_2)[3] = \"kommune_nr\"\nlibrary(tidyr)\ndf=spread(befolkning_verdensregion_2,vreg_2,tabellvariabel)\ndf$alle=extract_numeric(df[,6])+extract_numeric(df[,7])\n#er det innført NA?\nsum(is.na(df$alle))\ndf_2=gather(df,vreg_3,tabellvariabel,6:8,na.rm=F)\n#er ny df utvidet med riktig nrow?\nnrow(df_2)==nrow(befolkning_verdensregion_2)+nrow(df)-sum(is.na(df$alle))\nnrow(df_2)==nrow(befolkning_verdensregion_2)+sum(befolkning_verdensregion_2$vreg_2==\"1\")\nsum(df_2$vreg_3==\"alle\")==sum(befolkning_verdensregion_2$vreg_2==1)\n#anna informasjon som må oppdateres\ndf_2$tabell_navn=\"befolkning_verdensregion_3\"\nwrite.csv(df_2,\"D:/R/imdikator-munch/data_flat_output/befolkning_verdensregion_3-kommune-2015.csv\",row.names=F)\n\n#BEFOLKNING_VERDENSREGION_3 - naringsregion\nbefolkning_verdensregion_2 <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_verdensregion_2N.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\")\nbefolkning_verdensregion_2 = subset(befolkning_verdensregion_2,select=-8)\nbefolkning_verdensregion_2$naringsregion_id[nchar(befolkning_verdensregion_2$naringsregion_id)==1] = paste0(\"0\",befolkning_verdensregion_2$naringsregion_id[nchar(befolkning_verdensregion_2$naringsregion_id)==1])\nnames(befolkning_verdensregion_2)[3] = \"naringsregion_nr\"\nlibrary(tidyr)\ndf=spread(befolkning_verdensregion_2,vreg_2,tabellvariabel)\ndf$alle=extract_numeric(df[,6])+extract_numeric(df[,7])\n#er det innført NA?\nsum(is.na(df$alle))\ndf_2=gather(df,vreg_3,tabellvariabel,6:8,na.rm=F)\n#er ny df utvidet med riktig nrow?\nnrow(df_2)==nrow(befolkning_verdensregion_2)+nrow(df)-sum(is.na(df$alle))\nnrow(df_2)==nrow(befolkning_verdensregion_2)+sum(befolkning_verdensregion_2$vreg_2==\"1\")\nsum(df_2$vreg_3==\"alle\")==sum(befolkning_verdensregion_2$vreg_2==1)\n#anna informasjon som må oppdateres\ndf_2$tabell_navn=\"befolkning_verdensregion_3\"\nwrite.csv(df_2,\"D:/R/imdikator-munch/data_flat_output/befolkning_verdensregion_3-naringsregion-2015.csv\",row.names=F)\n\n#BEFOLKNING_VERDENSREGION_3 - fylke\nbefolkning_verdensregion_2 <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_verdensregion_2F.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\")\nbefolkning_verdensregion_2_norge <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_verdensregion_2L.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\")\nbefolkning_verdensregion_2 = rbind (befolkning_verdensregion_2,befolkning_verdensregion_2_norge)\nbefolkning_verdensregion_2 = subset(befolkning_verdensregion_2,select=-8)\nbefolkning_verdensregion_2$fylke_id[nchar(befolkning_verdensregion_2$fylke_id)==1] = paste0(\"0\",befolkning_verdensregion_2$fylke_id[nchar(befolkning_verdensregion_2$fylke_id)==1])\nnames(befolkning_verdensregion_2)[3] = \"fylke_nr\"\nlibrary(tidyr)\ndf=spread(befolkning_verdensregion_2,vreg_2,tabellvariabel)\ndf$alle=extract_numeric(df[,6])+extract_numeric(df[,7])\n#er det innført NA?\nsum(is.na(df$alle))\ndf_2=gather(df,vreg_3,tabellvariabel,6:8,na.rm=F)\n#er ny df utvidet med riktig nrow?\nnrow(df_2)==nrow(befolkning_verdensregion_2)+nrow(df)-sum(is.na(df$alle))\nnrow(df_2)==nrow(befolkning_verdensregion_2)+sum(befolkning_verdensregion_2$vreg_2==\"1\")\nsum(df_2$vreg_3==\"alle\")==sum(befolkning_verdensregion_2$vreg_2==1)\n#anna informasjon som må oppdateres\ndf_2$tabell_navn=\"befolkning_verdensregion_3\"\nwrite.csv(df_2,\"D:/R/imdikator-munch/data_flat_output/befolkning_verdensregion_3-fylke-2015.csv\",row.names=F)\n\n#BEFOLKNING_VERDENSREGION_6 - Bydel\nbefolkning_verdensregion_5 <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_verdensregion_5B.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\nbefolkning_verdensregion_5 = subset(befolkning_verdensregion_5,select=c(-8,-kjonn))\nbefolkning_verdensregion_5$bydel_id[nchar(befolkning_verdensregion_5$bydel_id)==2] = paste0(\"0301\",befolkning_verdensregion_5$bydel_id[nchar(befolkning_verdensregion_5$bydel_id)==2])\nnames(befolkning_verdensregion_5)[3] = \"bydel_nr\"\nlibrary(tidyr)\ndf=spread(befolkning_verdensregion_5,vreg_5,tabellvariabel)\ndf$alle=extract_numeric(df[,5])+extract_numeric(df[,6])+extract_numeric(df[,7])+extract_numeric(df[,8])+extract_numeric(df[,9])\n#er det innført NA?\nsum(is.na(df$alle))\ndf_2=gather(df,vreg_6,tabellvariabel,5:10,na.rm=F)\n#er ny df utvidet med riktig nrow?\nnrow(df_2)==nrow(befolkning_verdensregion_5)+nrow(df)-sum(is.na(df$alle))\nnrow(df_2)==nrow(befolkning_verdensregion_5)+sum(befolkning_verdensregion_5$vreg_5==\"afrika\")\nsum(df_2$vreg_6==\"alle\")==sum(befolkning_verdensregion_5$vreg_5==\"afrika\")\n#ingen avvik.\n#anna informasjon som må oppdateres\ndf_2$tabell_navn=\"befolkning_verdensregion_6\"\nwrite.csv(df_2,\"D:/R/imdikator-munch/data_flat_output/befolkning_verdensregion_6-bydel-2015.csv\",row.names=F)\n\n#BEFOLKNING_VERDENSREGION_6 - kommune\nbefolkning_verdensregion_5 <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_verdensregion_5K.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\nbefolkning_verdensregion_5 = subset(befolkning_verdensregion_5,select=c(-8,-kjonn))\nnames(befolkning_verdensregion_5)[3] = \"kommune_nr\"\nlibrary(tidyr)\ndf=spread(befolkning_verdensregion_5,vreg_5,tabellvariabel)\ndf$alle=extract_numeric(df[,5])+extract_numeric(df[,6])+extract_numeric(df[,7])+extract_numeric(df[,8])+extract_numeric(df[,9])\n#er det innført NA?\nsum(is.na(df$alle))\ndf_2=gather(df,vreg_6,tabellvariabel,5:10,na.rm=F)\n#er ny df utvidet med riktig nrow?\nnrow(df_2)==nrow(befolkning_verdensregion_5)+nrow(df)-sum(is.na(df$alle))\nnrow(df_2)==nrow(befolkning_verdensregion_5)+sum(befolkning_verdensregion_5$vreg_5==\"afrika\")\nsum(df_2$vreg_6==\"alle\")==sum(befolkning_verdensregion_5$vreg_5==\"afrika\")\n#ingen avvik.\n#anna informasjon som må oppdateres\ndf_2$tabell_navn=\"befolkning_verdensregion_6\"\nwrite.csv(df_2,\"D:/R/imdikator-munch/data_flat_output/befolkning_verdensregion_6-kommune-2015.csv\",row.names=F)\n\n#BEFOLKNING_VERDENSREGION_6 - naringsregion\nbefolkning_verdensregion_5 <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_verdensregion_5N.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\nbefolkning_verdensregion_5 = subset(befolkning_verdensregion_5,select=c(-8,-kjonn))\nnames(befolkning_verdensregion_5)[3] = \"naringsregion_nr\"\nlibrary(tidyr)\ndf=spread(befolkning_verdensregion_5,vreg_5,tabellvariabel)\ndf$alle=extract_numeric(df[,5])+extract_numeric(df[,6])+extract_numeric(df[,7])+extract_numeric(df[,8])+extract_numeric(df[,9])\n#er det innført NA?\nsum(is.na(df$alle))\ndf_2=gather(df,vreg_6,tabellvariabel,5:10,na.rm=F)\n#er ny df utvidet med riktig nrow?\nnrow(df_2)==nrow(befolkning_verdensregion_5)+nrow(df)-sum(is.na(df$alle))\nnrow(df_2)==nrow(befolkning_verdensregion_5)+sum(befolkning_verdensregion_5$vreg_5==\"afrika\")\nsum(df_2$vreg_6==\"alle\")==sum(befolkning_verdensregion_5$vreg_5==\"afrika\")\n#ingen avvik.\n#anna informasjon som må oppdateres\ndf_2$tabell_navn=\"befolkning_verdensregion_6\"\nwrite.csv(df_2,\"D:/R/imdikator-munch/data_flat_output/befolkning_verdensregion_6-naringsregion-2015.csv\",row.names=F)\n\n#BEFOLKNING_VERDENSREGION_6 - fylke + landet\nbefolkning_verdensregion_5 <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_verdensregion_5F.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\nbefolkning_verdensregion_5_norge <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_verdensregion_5L.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\nbefolkning_verdensregion_5=rbind(befolkning_verdensregion_5,befolkning_verdensregion_5_norge)\nbefolkning_verdensregion_5 = subset(befolkning_verdensregion_5,select=c(-8,-kjonn))\nnames(befolkning_verdensregion_5)[3] = \"fylke_nr\"\nlibrary(tidyr)\ndf=spread(befolkning_verdensregion_5,vreg_5,tabellvariabel)\ndf$alle=extract_numeric(df[,5])+extract_numeric(df[,6])+extract_numeric(df[,7])+extract_numeric(df[,8])+extract_numeric(df[,9])\n#er det innført NA?\nsum(is.na(df$alle))\ndf_2=gather(df,vreg_6,tabellvariabel,5:10,na.rm=F)\n#er ny df utvidet med riktig nrow?\nnrow(df_2)==nrow(befolkning_verdensregion_5)+nrow(df)-sum(is.na(df$alle))\nnrow(df_2)==nrow(befolkning_verdensregion_5)+sum(befolkning_verdensregion_5$vreg_5==\"afrika\")\nsum(df_2$vreg_6==\"alle\")==sum(befolkning_verdensregion_5$vreg_5==\"afrika\")\n#ingen avvik.\n#anna informasjon som må oppdateres\ndf_2$tabell_navn=\"befolkning_verdensregion_6\"\nwrite.csv(df_2,\"D:/R/imdikator-munch/data_flat_output/befolkning_verdensregion_6-fylke-2015.csv\",row.names=F)\n\n#BEFOLKNING-VERDENSREGION-9 - bydel\n#6. desember\nbefolkning_verdensregion_9 <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_verdensregion_9B.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\nbefolkning_verdensregion_9 = subset(befolkning_verdensregion_9,select=c(-8,-kjonn))\nbefolkning_verdensregion_9$bydel_id[nchar(befolkning_verdensregion_9$bydel_id)==2] = paste0(\"0301\",befolkning_verdensregion_9$bydel_id[nchar(befolkning_verdensregion_9$bydel_id)==2])\nnames(befolkning_verdensregion_9)[3] = \"bydel_nr\"\nbefolkning_verdensregion_9$tabell_navn=\"befolkning_verdensregion_9\"\nwrite.csv(befolkning_verdensregion_9,\"D:/R/imdikator-munch/data_flat_output/befolkning_verdensregion_9-bydel-2015.csv\",row.names=F)\n\n#BEFOLKNING-VERDENSREGION-9 - kommune\n#6. desember\nbefolkning_verdensregion_9 <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_verdensregion_9K.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\nbefolkning_verdensregion_9 = subset(befolkning_verdensregion_9,select=c(-8,-kjonn))\nnames(befolkning_verdensregion_9)[3] = \"kommune_nr\"\nbefolkning_verdensregion_9$tabell_navn=\"befolkning_verdensregion_9\"\nwrite.csv(befolkning_verdensregion_9,\"D:/R/imdikator-munch/data_flat_output/befolkning_verdensregion_9-kommune-2015.csv\",row.names=F)\n\n#BEFOLKNING-VERDENSREGION-9 - naringsregion\n#6. desember\nbefolkning_verdensregion_9 <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_verdensregion_9N.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\nbefolkning_verdensregion_9 = subset(befolkning_verdensregion_9,select=c(-8,-kjonn))\nnames(befolkning_verdensregion_9)[3] = \"naringsregion_nr\"\nbefolkning_verdensregion_9$tabell_navn=\"befolkning_verdensregion_9\"\nwrite.csv(befolkning_verdensregion_9,\"D:/R/imdikator-munch/data_flat_output/befolkning_verdensregion_9-naringsregion-2015.csv\",row.names=F)\n\n#BEFOLKNING-VERDENSREGION-9 - fylke\n#6. desember\nbefolkning_verdensregion_9 <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_verdensregion_9F.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\nbefolkning_verdensregion_9_norge <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_verdensregion_9L.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\nbefolkning_verdensregion_9 = rbind(befolkning_verdensregion_9,befolkning_verdensregion_9_norge)\nbefolkning_verdensregion_9 = subset(befolkning_verdensregion_9,select=c(-8,-kjonn))\nnames(befolkning_verdensregion_9)[3] = \"fylke_nr\"\nbefolkning_verdensregion_9$tabell_navn=\"befolkning_verdensregion_9\"\nwrite.csv(befolkning_verdensregion_9,\"D:/R/imdikator-munch/data_flat_output/befolkning_verdensregion_9-fylke-2015.csv\",row.names=F)\n\n#Befolkning_botid - bydel\n#7. desember 2015\nbefolkning_botid <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_botid_B_2015.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\n# bydel_id må bli bydel_nr\n# bydel_id = \" \" må ut\n# botid_5 == \" \" må bli \"alle\"\n# person må bli personer\n# bydel_nr må få 0301 foran.\n# tabellnavn skrevet med stor forbokstav\nnames(befolkning_botid)[3] = \"bydel_nr\"\nbefolkning_botid = subset(befolkning_botid,bydel_nr!=\" \")\nbefolkning_botid$bydel_nr[nchar(befolkning_botid$bydel_nr)==2] = paste0(\"0301\",befolkning_botid$bydel_nr[nchar(befolkning_botid$bydel_nr)==2])\nbefolkning_botid$botid_5[befolkning_botid$botid_5==\" \"]=\"alle\"\nbefolkning_botid$tabell_navn=\"befolkning_botid\"\nbefolkning_botid$enhet = \"personer\"\n#logisk sjekk av antall: 18 bydeler x 3 vreg x 4 botid x 1 enhet\nnrow(befolkning_botid)==18*3*4\n#viser seg at det mangler data for botid_5==alle for vreg_3==1 og ==2\ndf=spread(befolkning_botid,botid_5,tabellvariabel,drop=F)\ndf$alle_kopi=df$alle\ndf$alle=extract_numeric(df[,6])+extract_numeric(df[,7])+extract_numeric(df[,8])\ndf = subset(df,select=-alle_kopi)\nsum(is.na(df$alle))\nbefolkning_botid=gather(df,botid_5,tabellvariabel,6:9,na.rm=F)\nwrite.csv(befolkning_botid,\"D:/R/imdikator-munch/data_flat_output/befolkning_botid-bydel-2015.csv\",row.names=F)\n\n#Befolkning_botid - kommune\n#7. desember 2015\nbefolkning_botid <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_botid_K_2015_v2.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\n# bydel_id må bli bydel_nr\n# bydel_id = \" \" må ut\n# botid_5 == \" \" må bli \"alle\"\n# person må bli personer\n# bydel_nr må få 0301 foran.\n# tabellnavn skrevet med stor forbokstav\n# enhet må bli personer\n# logisk sjekk av innholdet\nnames(befolkning_botid)[3] = \"kommune_nr\"\nbefolkning_botid = subset(befolkning_botid,kommune_nr!=\"NULL\")\nbefolkning_botid$tabell_navn=\"befolkning_botid\"\nbefolkning_botid$enhet = \"personer\"\n#mangler alle-kategori for botid\ndf=spread(befolkning_botid,botid_5,tabellvariabel,drop=F,fill=\".\")\ndf$alle=extract_numeric(df[,6])+extract_numeric(df[,7])+extract_numeric(df[,8])\ndf = subset(df,select=-alle_kopi)\nsum(is.na(df$alle))\ndf$alle[is.na(df$alle)==T]=\".\"\nbefolkning_botid=gather(df,botid_5,tabellvariabel,6:9,na.rm=F)\n#fire botidsnivåer x 3 vreg x 428 kommuner\n4*3*428\nnlevels(as.factor(befolkning_botid$kommune_nr))\nlevels(as.factor(befolkning_botid$vreg_3))\nwrite.csv(befolkning_botid,\"D:/R/imdikator-munch/data_flat_output/befolkning_botid-kommune-2015.csv\",row.names=F)\n\n#Befolkning_botid - naringsregion\n#7. desember 2015\nbefolkning_botid <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_botid_N_2015.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\n# naringsregion_id = \"NULL\" må ut\n# tabellnavn skrevet med stor forbokstav\n# person må bli personer\n# logisk sjekk av innholdet\n# botid_5 == \" \" må bli \"alle\"\n# vreg_3 == \" \" må bli alle\n# enhet må bli personer\n\nbefolkning_botid = subset(befolkning_botid,naringsregion_nr!=\"NULL\")\nbefolkning_botid$tabell_navn=\"befolkning_botid\"\nbefolkning_botid$enhet = \"personer\"\n#4 botidsnivåer x 3 vregnivåer x 83 nareg\n4*3*83\nlevels(as.factor(befolkning_botid$vreg_3))\nbefolkning_botid$vreg_3[befolkning_botid$vreg_3==\" \"]=\"alle\"\nlevels(as.factor(befolkning_botid$botid_5))\n#mangler alle-kategori for botid for vreg==1 og ==2.\ndf=spread(befolkning_botid,botid_5,tabellvariabel,drop=F)\ndf$alle_kopi=df$alle\ndf$alle=extract_numeric(df[,6])+extract_numeric(df[,7])+extract_numeric(df[,8])\ndf = subset(df,select=-alle_kopi)\nsum(is.na(df$alle))\nbefolkning_botid=gather(df,botid_5,tabellvariabel,6:9,na.rm=F)\n#fire botidsnivåer x 3 vreg x 83 naringsregionr\n4*3*83\nnlevels(as.factor(befolkning_botid$naringsregion_nr))\nwrite.csv(befolkning_botid,\"D:/R/imdikator-munch/data_flat_output/befolkning_botid-naringsregion-2015.csv\",row.names=F)\n\n#Befolkning_botid - fylke\n#7. desember 2015\nbefolkning_botid <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_botid_F_2015.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\n# tabellnavn skrevet med stor forbokstav\n# person må bli personer\n# logisk sjekk av innholdet\n# botid_5 == \" \" må bli \"alle\"\n# vreg_3 == \" \" må bli alle\n# enhet må bli personer\nbefolkning_botid$tabell_navn=\"befolkning_botid\"\nbefolkning_botid$enhet = \"personer\"\n#4 botidsnivåer x 3 vregnivåer x nlevels(as.factor(befolkning_botid$fylke_nr))\n4*3*20\nlevels(as.factor(befolkning_botid$vreg_3))\nlevels(as.factor(befolkning_botid$botid_5))\n#mangler vreg_3==alle data for botidskategorier\ndf=spread(befolkning_botid,vreg_3,tabellvariabel,drop=F)\ndf$alle_kopi=df$alle\ndf$alle=extract_numeric(df[,6])+extract_numeric(df[,7])\ndf = subset(df,select=-alle_kopi)\nsum(is.na(df$alle))\ndf2=gather(df,vreg_3,tabellvariabel,6:8,na.rm=F)\n#mangler alle-kategori for botid for vreg==1 og ==2.\ndf=spread(df2,botid_5,tabellvariabel,drop=F)\ndf$alle=extract_numeric(df[,6])+extract_numeric(df[,7])+extract_numeric(df[,8])\nsum(is.na(df$alle))\nbefolkning_botid=gather(df,botid_5,tabellvariabel,6:9,na.rm=F)\n#fire botidsnivåer x 3 vreg x 83 fylker\n4*3*20\nwrite.csv(befolkning_botid,\"D:/R/imdikator-munch/data_flat_output/befolkning_botid-fylke-2015.csv\",row.names=F)\n\n#BEFOLKNING_FLYTTING\n#befolkning_flytting - bydel\n#9. desember 2015\nlibrary(tidyr)\nbefolkning_flytting <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_flytting_B_2014.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\",\", dec=\".\",colClasses=\"character\")\n# bydel_id må bli bydel_nr\n# bydel_nr må få 0301 foran.\n# tabellnavn må bli tabell_navn\n# tabell må splittes i to: en med vreg og en uten vreg\n# invkat2 må bli til invkat_3, dvs. befolkningen_forøvrig = alle-innvandrere\n# invkat_3 må bli innvkat_2\n# logisk sjekk av antall observasjoner etter det\nnames(befolkning_flytting)[1] = \"tabell_navn\"\nnames(befolkning_flytting)[3] = \"bydel_nr\"\nbefolkning_flytting$bydel_nr[nchar(befolkning_flytting$bydel_nr)==2] = paste0(\"0301\",befolkning_flytting$bydel_nr[nchar(befolkning_flytting$bydel_nr)==2])\n\n#befolkning_flytting_vreg\nbefolkning_flytting_vreg = subset(befolkning_flytting,invkat_2 =='innvandrere',select=-invkat_2)\nbefolkning_flytting_vreg$tabell_navn =\"befolkning_flytting_vreg\"\n#logisksjekk: 486 = 3*nlevels(as.factor(befolkning_flytting_vreg$bydel_nr))*nlevels(as.factor(befolkning_flytting_vreg$flytting))\nnrow(befolkning_flytting_vreg)==3*nlevels(as.factor(befolkning_flytting_vreg$bydel_nr))*nlevels(as.factor(befolkning_flytting_vreg$flytting))\nwrite.csv(befolkning_flytting_vreg,\"D:/R/imdikator-munch/data_flat_output/befolkning_flytting_vreg-bydel-2014.csv\",row.names=F)\n\n#befolkning_flytting\nbefolkning_flytting=subset(befolkning_flytting,vreg_3 =='alle',select=-vreg_3)\ndf=spread(befolkning_flytting,invkat_2,tabellvariabel,drop=F)\nsum(is.na(df$alle))\nsum(is.na(df$innvandrere))\ndf$befolkningen_ellers=extract_numeric(df[,6])-extract_numeric(df[,7])\ndf = subset(df,select=-alle_kopi)\nsum(is.na(df$befolkningen_ellers))\nbefolkning_flytting=gather(df,innvkat_3,tabellvariabel,6:8,na.rm=F)\nnrow(befolkning_flytting)==9*3*18\nwrite.csv(befolkning_flytting,\"D:/R/imdikator-munch/data_flat_output/befolkning_flytting-bydel-2014.csv\",row.names=F)\n\n#kommune\nbefolkning_flytting <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_flytting_K_2014.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\",\", dec=\".\",colClasses=\"character\")\n# tilflyttingskommune må bli kommune_nr\n# tabellnavn må bli tabell_navn\n# tabell må splittes i to: en med vreg og en uten vreg\n# invkat2 må bli til invkat_3, dvs. befolkningen_forøvrig = alle-innvandrere\n# invkat_3 må bli innvkat_2\n# logisk sjekk av antall observasjoner etter det\nnames(befolkning_flytting)[1] = \"tabell_navn\"\nnames(befolkning_flytting)[3] = \"kommune_nr\"\nlevels(as.factor(befolkning_flytting$flytting))\n\n#befolkning_flytting_vreg\nbefolkning_flytting_vreg = subset(befolkning_flytting,invkat_2 =='innvandrere',select=-invkat_2)\nbefolkning_flytting_vreg$tabell_navn =\"befolkning_flytting_vreg\"\n#logisksjekk: \nnrow(befolkning_flytting_vreg)==3*nlevels(as.factor(befolkning_flytting_vreg$kommune_nr))*nlevels(as.factor(befolkning_flytting_vreg$flytting))\nwrite.csv(befolkning_flytting_vreg,\"D:/R/imdikator-munch/data_flat_output/befolkning_flytting_vreg-kommune-2014.csv\",row.names=F)\n\n#befolkning_flytting\nbefolkning_flytting=subset(befolkning_flytting,vreg_3 =='alle',select=-vreg_3)\ndf=spread(befolkning_flytting,invkat_2,tabellvariabel,drop=F)\nsum(is.na(df$alle))\nsum(is.na(df$innvandrere))\ndf$befolkningen_ellers=extract_numeric(df[,6])-extract_numeric(df[,7])\nsum(is.na(df$befolkningen_ellers))\nbefolkning_flytting=gather(df,innvkat_3,tabellvariabel,6:8,na.rm=F)\nnrow(befolkning_flytting)==9*3*428\nwrite.csv(befolkning_flytting,\"D:/R/imdikator-munch/data_flat_output/befolkning_flytting-kommune-2014.csv\",row.names=F)\n\n#naringsregion\nbefolkning_flytting <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_flytting_N_2014.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\",\", dec=\".\",colClasses=\"character\")\n# tilflyttingsnaringsregion må bli naringsregion_nr\n# tabellnavn må bli tabell_navn\n# tabell må splittes i to: en med vreg og en uten vreg\n# invkat2 må bli til invkat_3, dvs. befolkningen_forøvrig = alle-innvandrere\n# invkat_3 må bli innvkat_2\n# logisk sjekk av antall observasjoner etter det\nnames(befolkning_flytting)[1] = \"tabell_navn\"\nnames(befolkning_flytting)[3] = \"naringsregion_nr\"\nlevels(as.factor(befolkning_flytting$flytting))\n\n#befolkning_flytting_vreg\nbefolkning_flytting_vreg = subset(befolkning_flytting,invkat_2 =='innvandrere',select=-invkat_2)\nbefolkning_flytting_vreg$tabell_navn =\"befolkning_flytting_vreg\"\n#logisksjekk: \nnrow(befolkning_flytting_vreg)==3*83*9\nwrite.csv(befolkning_flytting_vreg,\"D:/R/imdikator-munch/data_flat_output/befolkning_flytting_vreg-naringsregion-2014.csv\",row.names=F)\n\n#befolkning_flytting\nbefolkning_flytting=subset(befolkning_flytting,vreg_3 =='alle',select=-vreg_3)\ndf=spread(befolkning_flytting,invkat_2,tabellvariabel,drop=F)\nsum(is.na(df$alle))\nsum(is.na(df$innvandrere))\ndf$befolkningen_ellers=extract_numeric(df[,6])-extract_numeric(df[,7])\nsum(is.na(df$befolkningen_ellers))\nbefolkning_flytting=gather(df,innvkat_3,tabellvariabel,6:8,na.rm=F)\nnrow(befolkning_flytting)==9*3*83\nwrite.csv(befolkning_flytting,\"D:/R/imdikator-munch/data_flat_output/befolkning_flytting-naringsregion-2014.csv\",row.names=F)\n\n#fylke\nbefolkning_flytting <- read.csv(\"D:/R/imdikator-munch/data_flat_input/befolkning_flytting_FL_2014.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\",\", dec=\".\",colClasses=\"character\")\n# fylke_id må bli fylke_nr\n# tabellnavn må bli tabell_navn\n# fylke = 0 må bli 00\n# tabell må splittes i to: en med vreg og en uten vreg\n# invkat2 må bli til invkat_3, dvs. befolkningen_forøvrig = alle-innvandrere\n# invkat_3 må bli innvkat_2\n# logisk sjekk av antall observasjoner etter det\nnames(befolkning_flytting)[1] = \"tabell_navn\"\nnames(befolkning_flytting)[3] = \"fylke_nr\"\nbefolkning_flytting$fylke_nr[nchar(befolkning_flytting$fylke_nr)==1] = paste0(\"0\",befolkning_flytting$fylke_nr[nchar(befolkning_flytting$fylke_nr)==1])\nlevels(as.factor(befolkning_flytting$flytting))\n\n#befolkning_flytting_vreg\nbefolkning_flytting_vreg = subset(befolkning_flytting,invkat_2 =='innvandrere',select=-invkat_2)\nbefolkning_flytting_vreg$tabell_navn =\"befolkning_flytting_vreg\"\n#logisksjekk: \nnrow(befolkning_flytting_vreg)==3*20*9\nwrite.csv(befolkning_flytting_vreg,\"D:/R/imdikator-munch/data_flat_output/befolkning_flytting_vreg-fylke-2014.csv\",row.names=F)\n\n#befolkning_flytting\nbefolkning_flytting=subset(befolkning_flytting,vreg_3 =='alle',select=-vreg_3)\ndf=spread(befolkning_flytting,invkat_2,tabellvariabel,drop=F)\nsum(is.na(df$alle))\nsum(is.na(df$innvandrere))\ndf$befolkningen_ellers=extract_numeric(df[,6])-extract_numeric(df[,7])\nsum(is.na(df$befolkningen_ellers))\nbefolkning_flytting=gather(df,innvkat_3,tabellvariabel,6:8,na.rm=F)\nnrow(befolkning_flytting)==9*3*20\nwrite.csv(befolkning_flytting,\"D:/R/imdikator-munch/data_flat_output/befolkning_flytting-fylke-2014.csv\",row.names=F)\n\n#FLYKTNING_BOTID_FLYTTING\nflyktning_botid_flytting <- read.csv(\"D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_B_2015.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\n# bydel_id må bli bydel_nr\n# fjerne ekstra kolonne\n# kode om 0-4 til 0_4\n# bydeler må få 0301 foran\n# logisk sjekk av antall observasjoner etter det\nnames(flyktning_botid_flytting)[3] = \"bydel_nr\"\nflyktning_botid_flytting$bydel_nr[nchar(flyktning_botid_flytting$bydel_nr)==2] = paste0(\"0301\",flyktning_botid_flytting$bydel_nr[nchar(flyktning_botid_flytting$bydel_nr)==2])\nflyktning_botid_flytting$enhet[flyktning_botid_flytting$enhet==\"person\"]=\"personer\"\nflyktning_botid_flytting = subset(flyktning_botid_flytting,select=-X)\nlevels(as.factor(flyktning_botid_flytting$botid_3))\nlevels(as.factor(flyktning_botid_flytting$forste_bosettingskommune))\nflyktning_botid_flytting$botid_3 = gsub(\"\\\\-\",\"_\",flyktning_botid_flytting$botid_3)\nflyktning_botid_flytting$tabellvariabel = gsub(\"\\\\,\",\".\",flyktning_botid_flytting$tabellvariabel)\n3*4*18*2==nrow(flyktning_botid_flytting)\ndf=spread(flyktning_botid_flytting,botid_3,tabellvariabel,drop=F)\ndf$alle_kopi=df$alle\n#problem med komma som desimaltegn, må gsubbes til punktum lenger opp\ndf$alle=extract_numeric(df[,6])+extract_numeric(df[,7])\ndf$alle=as.numeric(df[,6])+as.numeric(df[,7])\ndf = subset(df,select=-alle_kopi)\nsum(is.na(df$alle))\ndf_2=gather(df,botid_3,tabellvariabel,6:8,na.rm=F)\nwrite.csv(df_2,\"D:/R/imdikator-munch/data_flat_output/flyktning_botid_flytting-bydel-2015.csv\",row.names=F)\n\n#FLYKTNING_BOTID_FLYTTING\n#KOMMUNE\nflyktning_botid_flytting <- read.csv(\"D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_K_2015.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\n# kommune_id må bli kommune_nr\n# fjerne ekstra kolonne\n# kode om 0-4 til 0_4\n#problem med komma som desimaltegn, må gsubbes til punktum lenger opp\n# logisk sjekk av antall observasjoner etter det\nnames(flyktning_botid_flytting)[3] = \"kommune_nr\"\nflyktning_botid_flytting$enhet[flyktning_botid_flytting$enhet==\"person\"]=\"personer\"\nflyktning_botid_flytting = subset(flyktning_botid_flytting,select=-X)\nlevels(as.factor(flyktning_botid_flytting$botid_3))\nlevels(as.factor(flyktning_botid_flytting$forste_bosettingskommune))\nflyktning_botid_flytting$botid_3 = gsub(\"\\\\-\",\"_\",flyktning_botid_flytting$botid_3)\nflyktning_botid_flytting$tabellvariabel = gsub(\"\\\\,\",\".\",flyktning_botid_flytting$tabellvariabel)\nnlevels(as.factor(flyktning_botid_flytting$kommune_nr))\n3*4*354*2==nrow(flyktning_botid_flytting)\ndf=spread(flyktning_botid_flytting,botid_3,tabellvariabel,drop=F)\ndf$alle_kopi=df$alle\ndf$alle=extract_numeric(df[,6])+extract_numeric(df[,7])\nsum(is.na(df$alle))\ndf = subset(df,select=-alle_kopi)\nsum(is.na(df$alle))\ndf_2=gather(df,botid_3,tabellvariabel,6:8,na.rm=F)\n3*4*354*2==nrow(df_2)\nwrite.csv(df_2,\"D:/R/imdikator-munch/data_flat_output/flyktning_botid_flytting-kommune-2015.csv\",row.names=F)\n\n#FLYKTNING_BOTID_FLYTTING\n#NÆRINGSREGION\nflyktning_botid_flytting <- read.csv(\"D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_N_2015.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\n# naringsregion_id må bli naringsregion_nr\n# fjerne ekstra kolonne\n# kode om 0-4 til 0_4\n#problem med komma som desimaltegn, må gsubbes til punktum lenger opp\n# logisk sjekk av antall observasjoner etter det\nnames(flyktning_botid_flytting)[3] = \"naringsregion_nr\"\nflyktning_botid_flytting$enhet[flyktning_botid_flytting$enhet==\"person\"]=\"personer\"\nflyktning_botid_flytting = subset(flyktning_botid_flytting,select=-X)\nlevels(as.factor(flyktning_botid_flytting$botid_3))\nlevels(as.factor(flyktning_botid_flytting$forste_bosettingskommune))\nflyktning_botid_flytting$botid_3 = gsub(\"\\\\-\",\"_\",flyktning_botid_flytting$botid_3)\nflyktning_botid_flytting$tabellvariabel = gsub(\"\\\\,\",\".\",flyktning_botid_flytting$tabellvariabel)\nnlevels(as.factor(flyktning_botid_flytting$naringsregion_nr))\n3*4*83*2==nrow(flyktning_botid_flytting)\ndf=spread(flyktning_botid_flytting,botid_3,tabellvariabel,drop=F)\ndf$alle_kopi=df$alle\ndf$alle=extract_numeric(df[,6])+extract_numeric(df[,7])\nsum(is.na(df$alle))\ndf = subset(df,select=-alle_kopi)\nsum(is.na(df$alle))\ndf_2=gather(df,botid_3,tabellvariabel,6:8,na.rm=F)\n3*4*83*2==nrow(df_2)\nwrite.csv(df_2,\"D:/R/imdikator-munch/data_flat_output/flyktning_botid_flytting-naringsregion-2015.csv\",row.names=F)\n\n#FLYKTNING_BOTID_FLYTTING\n#FYLKE\nflyktning_botid_flytting <- read.csv(\"D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_F_2015.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\nflyktning_botid_flytting_norge <- read.csv(\"D:/R/imdikator-munch/data_flat_input/flyktning_botid_flytting_L_2015.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\nflyktning_botid_flytting = rbind (flyktning_botid_flytting,flyktning_botid_flytting_norge)\n# fylke_id må bli fylke_nr\n# fjerne ekstra kolonne\n# kode om 0-4 til 0_4\n#problem med komma som desimaltegn, må gsubbes til punktum lenger opp\n# logisk sjekk av antall observasjoner etter det\nnames(flyktning_botid_flytting)[3] = \"fylke_nr\"\nflyktning_botid_flytting$enhet[flyktning_botid_flytting$enhet==\"person\"]=\"personer\"\nflyktning_botid_flytting = subset(flyktning_botid_flytting,select=-X)\nlevels(as.factor(flyktning_botid_flytting$botid_3))\nlevels(as.factor(flyktning_botid_flytting$forste_bosettingskommune))\nflyktning_botid_flytting$botid_3 = gsub(\"\\\\-\",\"_\",flyktning_botid_flytting$botid_3)\nflyktning_botid_flytting$tabellvariabel = gsub(\"\\\\,\",\".\",flyktning_botid_flytting$tabellvariabel)\nnlevels(as.factor(flyktning_botid_flytting$fylke_nr))\n3*4*20*2==nrow(flyktning_botid_flytting)\ndf=spread(flyktning_botid_flytting,botid_3,tabellvariabel,drop=F)\ndf$alle_kopi=df$alle\ndf$alle=extract_numeric(df[,6])+extract_numeric(df[,7])\nsum(is.na(df$alle))\ndf = subset(df,select=-alle_kopi)\nsum(is.na(df$alle))\ndf_2=gather(df,botid_3,tabellvariabel,6:8,na.rm=F)\n3*4*20*2==nrow(df_2)\nwrite.csv(df_2,\"D:/R/imdikator-munch/data_flat_output/flyktning_botid_flytting-fylke-2015.csv\",row.names=F)\n\n#SOSIALHJELP\n#10. desember\nsosialhjelp <- read.csv(\"D:/R/imdikator-munch/data_flat_input/sosialhjelp_2013-2014.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\",\", dec=\".\",colClasses=\"character\")\nnlevels(as.factor(sosialhjelp$bydel_nr))-1\nnlevels(as.factor(sosialhjelp$kommune_nr))-1\nnlevels(as.factor(sosialhjelp$naringsregion_nr))-1\nnlevels(as.factor(sosialhjelp$fylke_nr))-1\n#fylke 0 == 00\nsosialhjelp$fylke_nr[sosialhjelp$fylke_nr==\"0\"]=\"00\"\nsosialhjelp$enhet[sosialhjelp$enhet==\"person\"]=\"personer\"\n#logisk sjekk: \nnrow(sosialhjelp)==(18*3*3*2*2)+(428*3*3*2*2)+(83*3*3*2*2)+(20*3*3*2*2)\nwrite.csv(sosialhjelp,\"D:/R/imdikator-munch/data_flat_output/sosialhjelp-alle-2013_2014.csv\",row.names=F)\n\n#GRUNNSKOLEPOENG\n#10. desember\n# aar er feil - må kodes som siste året i intervallet, avgangsåret.\n# person må bli personer\n# logiske sjekker\ngrunnskolepoeng <- read.csv(\"D:/R/imdikator-munch/data_flat_input/grunnskolepoeng_bydel_2014_ny.csv\", row.names=NULL, na.strings=\"NA\", stringsAsFactors=FALSE, sep=\";\", dec=\",\",colClasses=\"character\")\ngrunnskolepoeng$aar[grunnskolepoeng$aar==\"2013-2014\"]=\"2014\"\ngrunnskolepoeng$enhet[grunnskolepoeng$enhet==\"person\"]=\"personer\"\n#logisk: 18 bydeler, 3 kjønn, 5 innvkat, 4 vreg, 4 invalder\n18*3*5*4*4\nlibrary(tidyr)\ndf=spread(grunnskolepoeng,innvkat_5,tabellvariabel,drop=F)\n#noe må gjøres med denne, kanskje tilsvarende som for flyktninger: skjære ut innvandrere som vi har mer informasjon om til egen tabell\n",
    "created" : 1445855157704.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "3488677306",
    "id" : "C2C481EF",
    "lastKnownWriteTime" : 1449762870,
    "path" : "D:/R/imdikator-munch/diagnose.R",
    "project_path" : "diagnose.R",
    "properties" : {
        "tempName" : "Untitled1"
    },
    "relative_order" : 1,
    "source_on_save" : false,
    "type" : "r_source"
}